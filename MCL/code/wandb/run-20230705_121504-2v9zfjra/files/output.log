
Epoch 1/1000
aver metric loss5.283e+00, aver reg loss3.034e-06
Total time 16.75770854949951
Epoch 2/1000
aver metric loss5.051e+00, aver reg loss1.210e-05
Total time 15.60599660873413
Epoch 3/1000
aver metric loss4.934e+00, aver reg loss2.024e-05
Total time 15.20349931716919
Epoch 4/1000
aver metric loss5.069e+00, aver reg loss2.608e-05
Total time 16.046261310577393
Epoch 5/1000
aver metric loss4.866e+00, aver reg loss2.885e-05
Total time 15.227925062179565
Epoch 6/1000
aver metric loss4.596e+00, aver reg loss2.919e-05
Total time 15.494266033172607
Epoch 7/1000
aver metric loss4.517e+00, aver reg loss3.226e-05
Total time 16.41315984725952
Epoch 8/1000
aver metric loss4.557e+00, aver reg loss3.485e-05
Total time 17.479589223861694
Epoch 9/1000
aver metric loss4.501e+00, aver reg loss3.688e-05
Total time 15.6946382522583
Epoch 10/1000
{'precision': array([0.04277754, 0.03589856, 0.02933824]), 'recall': array([0.03450426, 0.0560817 , 0.08964386]), 'ndcg': array([0.04921893, 0.05500003, 0.0669746 ])}
Best so far: [0.03450426 0.0560817  0.08964386 0.04921893 0.05500003 0.0669746 ]
aver metric loss4.462e+00, aver reg loss3.852e-05
Total time 30.004077672958374
Epoch 11/1000
aver metric loss4.342e+00, aver reg loss4.132e-05
Total time 14.281178712844849
Epoch 12/1000
aver metric loss4.352e+00, aver reg loss4.342e-05
Total time 16.401840925216675
Epoch 13/1000
aver metric loss4.345e+00, aver reg loss4.445e-05
Total time 15.53700566291809
Epoch 14/1000
aver metric loss4.341e+00, aver reg loss4.568e-05
Total time 16.56893754005432
Epoch 15/1000
aver metric loss4.348e+00, aver reg loss4.650e-05
Total time 15.882146120071411
Epoch 16/1000
aver metric loss4.268e+00, aver reg loss4.798e-05
Total time 16.19846248626709
Epoch 17/1000
aver metric loss4.266e+00, aver reg loss4.958e-05
Total time 16.66357398033142
Epoch 18/1000
aver metric loss4.272e+00, aver reg loss5.089e-05
Total time 17.026298761367798
Epoch 19/1000
aver metric loss4.272e+00, aver reg loss5.154e-05
Total time 16.882401704788208
Epoch 20/1000
{'precision': array([0.05153608, 0.0430943 , 0.03455807]), 'recall': array([0.04148557, 0.06764794, 0.10543482]), 'ndcg': array([0.05943452, 0.06640291, 0.0796085 ])}
Best so far: [0.04148557 0.06764794 0.10543482 0.05943452 0.06640291 0.0796085 ]
aver metric loss4.260e+00, aver reg loss5.211e-05
Total time 31.31252670288086
Epoch 21/1000
aver metric loss4.199e+00, aver reg loss5.343e-05
Total time 15.903367042541504
Epoch 22/1000
aver metric loss4.209e+00, aver reg loss5.465e-05
Total time 15.084948062896729
Epoch 23/1000
aver metric loss4.246e+00, aver reg loss5.523e-05
Total time 13.684606075286865
Epoch 24/1000
aver metric loss4.214e+00, aver reg loss5.593e-05
Total time 15.919980764389038
Epoch 25/1000
aver metric loss4.251e+00, aver reg loss5.621e-05
Total time 17.455123901367188
Epoch 26/1000
aver metric loss4.200e+00, aver reg loss5.699e-05
Total time 16.77525544166565
Epoch 27/1000
aver metric loss4.184e+00, aver reg loss5.824e-05
Total time 16.91861343383789
Epoch 28/1000
aver metric loss4.169e+00, aver reg loss5.904e-05
Total time 17.103445053100586
Epoch 29/1000
aver metric loss4.203e+00, aver reg loss5.968e-05
Total time 15.92847490310669
Epoch 30/1000
{'precision': array([0.05381827, 0.04468572, 0.03568007]), 'recall': array([0.04335058, 0.06990623, 0.10903498]), 'ndcg': array([0.06209155, 0.06900164, 0.08250556])}
Best so far: [0.04335058 0.06990623 0.10903498 0.06209155 0.06900164 0.08250556]
aver metric loss4.204e+00, aver reg loss6.004e-05
Total time 31.130961179733276
Epoch 31/1000
aver metric loss4.146e+00, aver reg loss6.095e-05
Total time 16.074002742767334
Epoch 32/1000
aver metric loss4.161e+00, aver reg loss6.191e-05
Total time 16.391486644744873
Epoch 33/1000
aver metric loss4.181e+00, aver reg loss6.249e-05
Total time 16.070725679397583
Epoch 34/1000
aver metric loss4.185e+00, aver reg loss6.293e-05
Total time 13.114922761917114
Epoch 35/1000
aver metric loss4.181e+00, aver reg loss6.302e-05
Total time 14.08995532989502
Epoch 36/1000
aver metric loss4.156e+00, aver reg loss6.362e-05
Total time 15.746277809143066
Epoch 37/1000
aver metric loss4.129e+00, aver reg loss6.471e-05
Total time 15.663001775741577
Epoch 38/1000
aver metric loss4.130e+00, aver reg loss6.538e-05
Total time 16.72381830215454
Epoch 39/1000
aver metric loss4.143e+00, aver reg loss6.577e-05
Total time 16.230304718017578
Epoch 40/1000
{'precision': array([0.05407014, 0.04544327, 0.03647197]), 'recall': array([0.04326668, 0.0711835 , 0.11126492]), 'ndcg': array([0.06244246, 0.06996039, 0.08390948])}
Best so far: [0.04326668 0.0711835  0.11126492 0.06244246 0.06996039 0.08390948]
aver metric loss4.138e+00, aver reg loss6.615e-05
Total time 29.053954601287842
Epoch 41/1000
aver metric loss4.120e+00, aver reg loss6.674e-05
Total time 16.369821548461914
Epoch 42/1000
aver metric loss4.097e+00, aver reg loss6.782e-05
Total time 16.742953062057495
Epoch 43/1000
aver metric loss4.123e+00, aver reg loss6.814e-05
Total time 16.054654359817505
Epoch 44/1000
aver metric loss4.148e+00, aver reg loss6.811e-05
Total time 16.89753794670105
Epoch 45/1000
aver metric loss4.151e+00, aver reg loss6.817e-05
Total time 16.31855297088623
Epoch 46/1000
aver metric loss4.131e+00, aver reg loss6.888e-05
Total time 15.780932426452637
Epoch 47/1000
aver metric loss4.121e+00, aver reg loss6.970e-05
Total time 13.78347110748291
Epoch 48/1000
aver metric loss4.119e+00, aver reg loss7.012e-05
Total time 16.325355768203735
Epoch 49/1000
aver metric loss4.117e+00, aver reg loss7.059e-05
Total time 16.884371519088745
Epoch 50/1000
{'precision': array([0.05467313, 0.04567798, 0.03674198]), 'recall': array([0.04369681, 0.07125039, 0.11175976]), 'ndcg': array([0.06339736, 0.07050371, 0.08449552])}
Best so far: [0.04369681 0.07125039 0.11175976 0.06339736 0.07050371 0.08449552]
aver metric loss4.090e+00, aver reg loss7.085e-05
Total time 31.518834829330444
Epoch 51/1000
aver metric loss4.096e+00, aver reg loss7.141e-05
Total time 16.126066207885742
Epoch 52/1000
aver metric loss4.096e+00, aver reg loss7.212e-05
Total time 16.363633155822754
Epoch 53/1000
aver metric loss4.115e+00, aver reg loss7.239e-05
Total time 16.33088707923889
Epoch 54/1000
aver metric loss4.120e+00, aver reg loss7.270e-05
Total time 15.649937629699707
Epoch 55/1000
aver metric loss4.093e+00, aver reg loss7.306e-05
Total time 16.33232355117798
Epoch 56/1000
aver metric loss4.091e+00, aver reg loss7.361e-05
Total time 16.198461055755615
Epoch 57/1000
aver metric loss4.072e+00, aver reg loss7.431e-05
Total time 17.59790015220642
Epoch 58/1000
aver metric loss4.108e+00, aver reg loss7.464e-05
Total time 15.073380947113037
Epoch 59/1000
aver metric loss4.113e+00, aver reg loss7.464e-05
Total time 13.307320356369019
Epoch 60/1000
{'precision': array([0.05537152, 0.04617983, 0.03700721]), 'recall': array([0.04435865, 0.07221148, 0.11286182]), 'ndcg': array([0.064473  , 0.07155689, 0.08555628])}
Best so far: [0.04435865 0.07221148 0.11286182 0.064473   0.07155689 0.08555628]
aver metric loss4.111e+00, aver reg loss7.501e-05
Total time 29.168745517730713
Epoch 61/1000
aver metric loss4.101e+00, aver reg loss7.517e-05
Total time 16.03684377670288
Epoch 62/1000
aver metric loss4.095e+00, aver reg loss7.593e-05
Total time 16.890032291412354
Epoch 63/1000
aver metric loss4.092e+00, aver reg loss7.618e-05
Total time 16.282493352890015
Epoch 64/1000
aver metric loss4.096e+00, aver reg loss7.628e-05
Total time 16.683479070663452
Epoch 65/1000
aver metric loss4.068e+00, aver reg loss7.680e-05
Total time 15.828785181045532
Epoch 66/1000
aver metric loss4.084e+00, aver reg loss7.726e-05
Total time 16.22294783592224
Epoch 67/1000
aver metric loss4.063e+00, aver reg loss7.760e-05
Total time 16.536860704421997
Epoch 68/1000
aver metric loss4.089e+00, aver reg loss7.816e-05
Total time 16.26739192008972
Epoch 69/1000
Traceback (most recent call last):
  File "main.py", line 123, in <module>
    output_information = Procedure.Metric_train_original(args, dataset, model, metric, epoch, sampler, w)
  File "/data1/deepdog/project/GFML/MCL/code/Procedure.py", line 34, in Metric_train_original
    metric_loss, reg_loss, pos_loss, neg_loss = metric.stageOne(S, num_items_per_user)
  File "/data1/deepdog/project/GFML/MCL/code/utils.py", line 39, in stageOne
    metric_loss, reg_loss, pos_loss, neg_loss = self.model.loss(S, num_items_per_user)
  File "/data1/deepdog/project/GFML/MCL/code/model.py", line 217, in loss
    neg_length = torch.repeat_interleave(torch.tensor(neg_length), num_items_per_user)
KeyboardInterrupt