
Epoch 1/1000
aver metric loss5.138e+00, aver reg loss4.482e-06
Total time 19.92871880531311
Epoch 2/1000
aver metric loss5.108e+00, aver reg loss1.263e-05
Total time 18.526567459106445
Epoch 3/1000
aver metric loss5.309e+00, aver reg loss1.658e-05
Total time 19.734554052352905
Epoch 4/1000
aver metric loss5.172e+00, aver reg loss1.988e-05
Total time 19.193796396255493
Epoch 5/1000
aver metric loss5.132e+00, aver reg loss2.582e-05
Total time 19.183016061782837
Epoch 6/1000
aver metric loss5.043e+00, aver reg loss2.254e-05
Total time 18.676787614822388
Epoch 7/1000
aver metric loss4.972e+00, aver reg loss2.363e-05
Total time 18.341978073120117
Epoch 8/1000
aver metric loss4.983e+00, aver reg loss2.527e-05
Total time 17.400681257247925
Epoch 9/1000
aver metric loss5.050e+00, aver reg loss2.720e-05
Total time 18.675134897232056
Epoch 10/1000
{'precision': array([0.01049435, 0.00966633, 0.00854692]), 'recall': array([0.01120821, 0.02066685, 0.03601017]), 'ndcg': array([0.01269872, 0.01620288, 0.02168107])}
Best so far: [0.01120821 0.02066685 0.03601017 0.01269872 0.01620288 0.02168107]
aver metric loss5.069e+00, aver reg loss3.003e-05
Total time 41.44959092140198
Epoch 11/1000
aver metric loss4.856e+00, aver reg loss2.889e-05
Total time 19.2288601398468
Epoch 12/1000
aver metric loss4.842e+00, aver reg loss3.041e-05
Total time 19.45703935623169
Epoch 13/1000
aver metric loss4.934e+00, aver reg loss3.181e-05
Total time 19.495779514312744
Epoch 14/1000
aver metric loss4.880e+00, aver reg loss3.250e-05
Total time 19.027366161346436
Epoch 15/1000
aver metric loss4.916e+00, aver reg loss3.409e-05
Total time 19.057169198989868
Epoch 16/1000
aver metric loss4.752e+00, aver reg loss3.562e-05
Total time 18.089073657989502
Epoch 17/1000
aver metric loss4.759e+00, aver reg loss3.724e-05
Total time 19.32808828353882
Epoch 18/1000
aver metric loss4.768e+00, aver reg loss3.871e-05
Total time 18.09240961074829
Epoch 19/1000
aver metric loss4.812e+00, aver reg loss3.971e-05
Total time 18.534708261489868
Epoch 20/1000
{'precision': array([0.01638177, 0.01476473, 0.01296505]), 'recall': array([0.01748461, 0.03158003, 0.0549133 ]), 'ndcg': array([0.02025399, 0.02532988, 0.03357509])}
Best so far: [0.01748461 0.03158003 0.0549133  0.02025399 0.02532988 0.03357509]
aver metric loss4.859e+00, aver reg loss4.086e-05
Total time 42.34247159957886
Epoch 21/1000
aver metric loss4.715e+00, aver reg loss4.271e-05
Total time 19.32049536705017
Epoch 22/1000
aver metric loss4.727e+00, aver reg loss4.421e-05
Total time 18.986330032348633
Epoch 23/1000
aver metric loss4.740e+00, aver reg loss4.549e-05
Total time 19.214667320251465
Epoch 24/1000
aver metric loss4.789e+00, aver reg loss4.642e-05
Total time 17.87518072128296
Epoch 25/1000
aver metric loss4.836e+00, aver reg loss4.713e-05
Total time 18.82693910598755
Epoch 26/1000
aver metric loss4.689e+00, aver reg loss4.925e-05
Total time 18.806066751480103
Epoch 27/1000
aver metric loss4.715e+00, aver reg loss5.065e-05
Total time 19.344125747680664
Epoch 28/1000
aver metric loss4.722e+00, aver reg loss5.152e-05
Total time 19.369904279708862
Epoch 29/1000
aver metric loss4.781e+00, aver reg loss5.177e-05
Total time 18.585198640823364
Epoch 30/1000
{'precision': array([0.01683323, 0.01523876, 0.01333186]), 'recall': array([0.01838877, 0.03298606, 0.05698482]), 'ndcg': array([0.02082974, 0.02622879, 0.03474139])}
Best so far: [0.01838877 0.03298606 0.05698482 0.02082974 0.02622879 0.03474139]
aver metric loss4.767e+00, aver reg loss5.268e-05
Total time 41.35765600204468
Epoch 31/1000
aver metric loss4.635e+00, aver reg loss5.545e-05
Total time 19.0270779132843
Epoch 32/1000
aver metric loss4.644e+00, aver reg loss5.646e-05
Total time 17.981542110443115
Epoch 33/1000
aver metric loss4.657e+00, aver reg loss5.768e-05
Total time 19.422585010528564
Epoch 34/1000
aver metric loss4.675e+00, aver reg loss5.811e-05
Total time 19.02731156349182
Epoch 35/1000
aver metric loss4.680e+00, aver reg loss5.857e-05
Total time 18.661571741104126
Epoch 36/1000
aver metric loss4.585e+00, aver reg loss6.034e-05
Total time 18.153666019439697
Epoch 37/1000
aver metric loss4.613e+00, aver reg loss6.223e-05
Total time 17.69736933708191
Epoch 38/1000
aver metric loss4.629e+00, aver reg loss6.222e-05
Total time 18.03385639190674
Epoch 39/1000
aver metric loss4.649e+00, aver reg loss6.273e-05
Total time 18.320035457611084
Epoch 40/1000
{'precision': array([0.01826148, 0.01647617, 0.01433584]), 'recall': array([0.0193225 , 0.03488082, 0.0604023 ]), 'ndcg': array([0.02235257, 0.02793468, 0.03685315])}
Best so far: [0.0193225  0.03488082 0.0604023  0.02235257 0.02793468 0.03685315]
aver metric loss4.649e+00, aver reg loss6.349e-05
Total time 40.39805269241333
Epoch 41/1000
aver metric loss4.596e+00, aver reg loss6.517e-05
Total time 19.645390510559082
Epoch 42/1000
aver metric loss4.584e+00, aver reg loss6.624e-05
Total time 19.283721685409546
Epoch 43/1000
aver metric loss4.605e+00, aver reg loss6.689e-05
Total time 18.665626287460327
Epoch 44/1000
aver metric loss4.622e+00, aver reg loss6.713e-05
Total time 19.49027395248413
Epoch 45/1000
aver metric loss4.631e+00, aver reg loss6.688e-05
Total time 18.526480436325073
Epoch 46/1000
aver metric loss4.557e+00, aver reg loss6.860e-05
Total time 18.37510585784912
Epoch 47/1000
aver metric loss4.573e+00, aver reg loss6.982e-05
Total time 19.44368028640747
Epoch 48/1000
aver metric loss4.591e+00, aver reg loss7.014e-05
Total time 18.73220181465149
Epoch 49/1000
aver metric loss4.592e+00, aver reg loss7.007e-05
Total time 19.014713287353516
Epoch 50/1000
{'precision': array([0.018479  , 0.01683323, 0.01469496]), 'recall': array([0.01978275, 0.03578855, 0.06176581]), 'ndcg': array([0.02267374, 0.0285531 , 0.03769917])}
Best so far: [0.01978275 0.03578855 0.06176581 0.02267374 0.0285531  0.03769917]
aver metric loss4.582e+00, aver reg loss7.028e-05
Total time 40.66103172302246
Epoch 51/1000
aver metric loss4.533e+00, aver reg loss7.252e-05
Total time 19.04357409477234
Epoch 52/1000
aver metric loss4.555e+00, aver reg loss7.303e-05
Total time 19.42095685005188
Epoch 53/1000
aver metric loss4.564e+00, aver reg loss7.279e-05
Total time 19.359254121780396
Epoch 54/1000
aver metric loss4.583e+00, aver reg loss7.294e-05
Total time 18.657028198242188
Epoch 55/1000
aver metric loss4.592e+00, aver reg loss7.361e-05
Total time 19.420718669891357
Epoch 56/1000
aver metric loss4.540e+00, aver reg loss7.484e-05
Total time 19.152373790740967
Epoch 57/1000
aver metric loss4.534e+00, aver reg loss7.587e-05
Total time 18.908053874969482
Epoch 58/1000
aver metric loss4.549e+00, aver reg loss7.606e-05
Total time 18.892392873764038
Epoch 59/1000
aver metric loss4.569e+00, aver reg loss7.604e-05
Total time 17.943211793899536
Epoch 60/1000
{'precision': array([0.01901254, 0.0170015 , 0.01477345]), 'recall': array([0.02016183, 0.03578065, 0.0619978 ]), 'ndcg': array([0.02327523, 0.02888517, 0.03803119])}
Best so far: [0.02016183 0.03578065 0.0619978  0.02327523 0.02888517 0.03803119]
aver metric loss4.586e+00, aver reg loss7.511e-05
Total time 41.957011222839355
Epoch 61/1000
aver metric loss4.523e+00, aver reg loss7.657e-05
Total time 18.225571155548096
Epoch 62/1000
aver metric loss4.523e+00, aver reg loss7.802e-05
Total time 19.353440046310425
Epoch 63/1000
aver metric loss4.547e+00, aver reg loss7.833e-05
Total time 19.175655364990234
Epoch 64/1000
aver metric loss4.567e+00, aver reg loss7.809e-05
Total time 19.265828847885132
Epoch 65/1000
aver metric loss4.564e+00, aver reg loss7.803e-05
Total time 18.84752106666565
Epoch 66/1000
aver metric loss4.510e+00, aver reg loss7.873e-05
Total time 19.164501428604126
Epoch 67/1000
aver metric loss4.520e+00, aver reg loss7.961e-05
Total time 17.547359228134155
Epoch 68/1000
aver metric loss4.550e+00, aver reg loss8.003e-05
Total time 19.476431131362915
Epoch 69/1000
aver metric loss4.608e+00, aver reg loss7.920e-05
Total time 18.790743589401245
Epoch 70/1000
{'precision': array([0.01909257, 0.01718926, 0.01491966]), 'recall': array([0.02012376, 0.03609241, 0.06248877]), 'ndcg': array([0.023351  , 0.02905436, 0.03825815])}
Best so far: [0.02012376 0.03609241 0.06248877 0.023351   0.02905436 0.03825815]
aver metric loss4.561e+00, aver reg loss7.933e-05
Total time 39.5061776638031
Epoch 71/1000
aver metric loss4.498e+00, aver reg loss8.042e-05
Total time 18.899547815322876
Epoch 72/1000
aver metric loss4.522e+00, aver reg loss8.076e-05
Total time 19.465080738067627
Epoch 73/1000
aver metric loss4.537e+00, aver reg loss8.125e-05
Total time 19.28757667541504
Epoch 74/1000
aver metric loss4.558e+00, aver reg loss8.005e-05
Total time 18.844740867614746
Epoch 75/1000
aver metric loss4.548e+00, aver reg loss7.941e-05
Total time 18.75423550605774
Epoch 76/1000
aver metric loss4.488e+00, aver reg loss8.109e-05
Total time 18.924659967422485
Epoch 77/1000
aver metric loss4.507e+00, aver reg loss8.173e-05
Total time 18.32622528076172
Epoch 78/1000
aver metric loss4.524e+00, aver reg loss8.133e-05
Total time 18.500008583068848
Epoch 79/1000
aver metric loss4.545e+00, aver reg loss8.091e-05
Total time 18.894428968429565
Epoch 80/1000
{'precision': array([0.01921364, 0.01733394, 0.01512077]), 'recall': array([0.02021929, 0.03640847, 0.06337703]), 'ndcg': array([0.02346508, 0.02928076, 0.03872237])}
Best so far: [0.02021929 0.03640847 0.06337703 0.02346508 0.02928076 0.03872237]
aver metric loss4.543e+00, aver reg loss8.147e-05
Total time 41.66877245903015
Epoch 81/1000
aver metric loss4.492e+00, aver reg loss8.191e-05
Total time 18.36122965812683
Epoch 82/1000
aver metric loss4.486e+00, aver reg loss8.225e-05
Total time 18.300182342529297
Epoch 83/1000
aver metric loss4.501e+00, aver reg loss8.297e-05
Total time 18.472785234451294
Epoch 84/1000
aver metric loss4.516e+00, aver reg loss8.260e-05
Total time 18.243268251419067
Epoch 85/1000
aver metric loss4.513e+00, aver reg loss8.254e-05
Total time 19.00358819961548
Epoch 86/1000
aver metric loss4.471e+00, aver reg loss8.370e-05
Total time 19.49486541748047
Epoch 87/1000
aver metric loss4.477e+00, aver reg loss8.436e-05
Total time 18.619718074798584
Epoch 88/1000
aver metric loss4.501e+00, aver reg loss8.351e-05
Total time 18.321248054504395
Epoch 89/1000
aver metric loss4.520e+00, aver reg loss8.400e-05
Total time 18.55980658531189
Epoch 90/1000
{'precision': array([0.01914182, 0.01732881, 0.01513564]), 'recall': array([0.02026344, 0.03661216, 0.06359569]), 'ndcg': array([0.02344567, 0.02940715, 0.03888786])}
Best so far: [0.02026344 0.03661216 0.06359569 0.02344567 0.02940715 0.03888786]
aver metric loss4.505e+00, aver reg loss8.396e-05
Total time 41.681496381759644
Epoch 91/1000
aver metric loss4.463e+00, aver reg loss8.462e-05
Total time 18.401496648788452
Epoch 92/1000
aver metric loss4.472e+00, aver reg loss8.512e-05
Total time 18.649145126342773
Epoch 93/1000
aver metric loss4.501e+00, aver reg loss8.540e-05
Total time 19.69716215133667
Epoch 94/1000
aver metric loss4.514e+00, aver reg loss8.446e-05
Total time 19.721537590026855
Epoch 95/1000
aver metric loss4.493e+00, aver reg loss8.476e-05
Total time 18.987236261367798
Epoch 96/1000
aver metric loss4.455e+00, aver reg loss8.540e-05
Total time 19.27305507659912
Epoch 97/1000
aver metric loss4.467e+00, aver reg loss8.661e-05
Total time 18.64420175552368
Epoch 98/1000
aver metric loss4.488e+00, aver reg loss8.647e-05
Total time 18.180877923965454
Epoch 99/1000
aver metric loss4.517e+00, aver reg loss8.557e-05
Total time 18.440146684646606
Epoch 100/1000
{'precision': array([0.01936755, 0.01739242, 0.0150669 ]), 'recall': array([0.02038765, 0.03655091, 0.06292314]), 'ndcg': array([0.02378938, 0.0295706 , 0.0387826 ])}
Best so far: [0.02026344 0.03661216 0.06359569 0.02344567 0.02940715 0.03888786]
aver metric loss4.505e+00, aver reg loss8.508e-05
Total time 41.47839641571045
Epoch 101/1000
aver metric loss4.464e+00, aver reg loss8.553e-05
Total time 14.629863262176514
Epoch 102/1000
aver metric loss4.468e+00, aver reg loss8.645e-05
Total time 17.859965324401855
Epoch 103/1000
aver metric loss4.482e+00, aver reg loss8.633e-05
Total time 18.556260585784912
Epoch 104/1000
Traceback (most recent call last):
  File "main.py", line 123, in <module>
    output_information = Procedure.Metric_train_original(args, dataset, model, metric, epoch, sampler, w)
  File "/data1/deepdog/project/GFML/MCL/code/Procedure.py", line 34, in Metric_train_original
    metric_loss, reg_loss, pos_loss, neg_loss = metric.stageOne(S, num_items_per_user)
  File "/data1/deepdog/project/GFML/MCL/code/utils.py", line 39, in stageOne
    metric_loss, reg_loss, pos_loss, neg_loss = self.model.loss(S, num_items_per_user)
  File "/data1/deepdog/project/GFML/MCL/code/model.py", line 205, in loss
    min_neg_length = min_neg_per_item[start_idx: start_idx + i].min()
KeyboardInterrupt