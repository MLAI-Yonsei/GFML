
Epoch 1/1000
aver metric loss4.950e+00, aver reg loss6.044e-06
Total time 20.023834228515625
Epoch 2/1000
aver metric loss4.655e+00, aver reg loss2.209e-05
Total time 19.04457926750183
Epoch 3/1000
aver metric loss4.894e+00, aver reg loss3.112e-05
Total time 18.712130308151245
Epoch 4/1000
aver metric loss4.531e+00, aver reg loss3.503e-05
Total time 19.125184774398804
Epoch 5/1000
aver metric loss4.456e+00, aver reg loss3.857e-05
Total time 18.402973175048828
Epoch 6/1000
aver metric loss4.194e+00, aver reg loss4.103e-05
Total time 19.215872049331665
Epoch 7/1000
aver metric loss4.087e+00, aver reg loss4.436e-05
Total time 19.042996644973755
Epoch 8/1000
aver metric loss4.077e+00, aver reg loss4.712e-05
Total time 19.51234769821167
Epoch 9/1000
aver metric loss4.116e+00, aver reg loss4.935e-05
Total time 19.17376446723938
Epoch 10/1000
{'precision': array([0.01870678, 0.01650695, 0.01424709]), 'recall': array([0.01943158, 0.03392553, 0.05800576]), 'ndcg': array([0.02280525, 0.02787299, 0.03636896])}
Best so far: [0.01943158 0.03392553 0.05800576 0.02280525 0.02787299 0.03636896]
aver metric loss4.141e+00, aver reg loss5.098e-05
Total time 44.665998697280884
Epoch 11/1000
aver metric loss3.896e+00, aver reg loss5.458e-05
Total time 18.898916482925415
Epoch 12/1000
aver metric loss3.922e+00, aver reg loss5.742e-05
Total time 16.564663648605347
Epoch 13/1000
aver metric loss3.966e+00, aver reg loss5.888e-05
Total time 17.787755727767944
Epoch 14/1000
aver metric loss3.953e+00, aver reg loss6.020e-05
Total time 18.723897218704224
Epoch 15/1000
aver metric loss3.942e+00, aver reg loss6.196e-05
Total time 18.633387088775635
Epoch 16/1000
aver metric loss3.837e+00, aver reg loss6.573e-05
Total time 19.181249856948853
Epoch 17/1000
aver metric loss3.810e+00, aver reg loss6.889e-05
Total time 18.812997102737427
Epoch 18/1000
aver metric loss3.833e+00, aver reg loss7.084e-05
Total time 18.89345145225525
Epoch 19/1000
aver metric loss3.841e+00, aver reg loss7.236e-05
Total time 18.934250354766846
Epoch 20/1000
{'precision': array([0.0223718 , 0.01990827, 0.01703331]), 'recall': array([0.02358112, 0.04163191, 0.0703418 ]), 'ndcg': array([0.02763932, 0.03403492, 0.04413632])}
Best so far: [0.02358112 0.04163191 0.0703418  0.02763932 0.03403492 0.04413632]
aver metric loss3.832e+00, aver reg loss7.451e-05
Total time 42.221518754959106
Epoch 21/1000
aver metric loss3.749e+00, aver reg loss7.834e-05
Total time 18.319038152694702
Epoch 22/1000
aver metric loss3.728e+00, aver reg loss8.142e-05
Total time 18.847934007644653
Epoch 23/1000
aver metric loss3.754e+00, aver reg loss8.351e-05
Total time 19.026355028152466
Epoch 24/1000
aver metric loss3.782e+00, aver reg loss8.487e-05
Total time 17.631951808929443
Epoch 25/1000
aver metric loss3.750e+00, aver reg loss8.701e-05
Total time 18.66084909439087
Epoch 26/1000
aver metric loss3.661e+00, aver reg loss9.140e-05
Total time 18.053200006484985
Epoch 27/1000
aver metric loss3.687e+00, aver reg loss9.457e-05
Total time 18.63345432281494
Epoch 28/1000
aver metric loss3.697e+00, aver reg loss9.598e-05
Total time 18.790281295776367
Epoch 29/1000
aver metric loss3.714e+00, aver reg loss9.739e-05
Total time 18.014524459838867
Epoch 30/1000
{'precision': array([0.02407092, 0.02112003, 0.0179511 ]), 'recall': array([0.02575459, 0.04487503, 0.07519837]), 'ndcg': array([0.02992232, 0.0366159 , 0.04722678])}
Best so far: [0.02575459 0.04487503 0.07519837 0.02992232 0.0366159  0.04722678]
aver metric loss3.702e+00, aver reg loss9.952e-05
Total time 45.42366313934326
Epoch 31/1000
aver metric loss3.641e+00, aver reg loss1.032e-04
Total time 18.864997386932373
Epoch 32/1000
aver metric loss3.636e+00, aver reg loss1.065e-04
Total time 18.98819851875305
Epoch 33/1000
aver metric loss3.660e+00, aver reg loss1.080e-04
Total time 17.59122061729431
Epoch 34/1000
aver metric loss3.661e+00, aver reg loss1.096e-04
Total time 16.975871324539185
Epoch 35/1000
aver metric loss3.644e+00, aver reg loss1.120e-04
Total time 18.44672155380249
Epoch 36/1000
aver metric loss3.616e+00, aver reg loss1.153e-04
Total time 19.168925285339355
Epoch 37/1000
aver metric loss3.594e+00, aver reg loss1.184e-04
Total time 17.83467984199524
Epoch 38/1000
aver metric loss3.635e+00, aver reg loss1.198e-04
Total time 19.189510822296143
Epoch 39/1000
aver metric loss3.653e+00, aver reg loss1.209e-04
Total time 18.591240644454956
Epoch 40/1000
{'precision': array([0.02453674, 0.02172847, 0.01842923]), 'recall': array([0.02626341, 0.04612615, 0.07736684]), 'ndcg': array([0.03051878, 0.03753988, 0.04841648])}
Best so far: [0.02626341 0.04612615 0.07736684 0.03051878 0.03753988 0.04841648]
aver metric loss3.624e+00, aver reg loss1.236e-04
Total time 42.716920375823975
Epoch 41/1000
aver metric loss3.590e+00, aver reg loss1.267e-04
Total time 17.598490238189697
Epoch 42/1000
aver metric loss3.588e+00, aver reg loss1.294e-04
Total time 19.3730525970459
Epoch 43/1000
aver metric loss3.610e+00, aver reg loss1.308e-04
Total time 18.74974822998047
Epoch 44/1000
aver metric loss3.614e+00, aver reg loss1.319e-04
Total time 19.187071800231934
Epoch 45/1000
aver metric loss3.586e+00, aver reg loss1.347e-04
Total time 18.919750928878784
Epoch 46/1000
aver metric loss3.590e+00, aver reg loss1.369e-04
Total time 19.51774024963379
Epoch 47/1000
aver metric loss3.574e+00, aver reg loss1.396e-04
Total time 18.50444269180298
Epoch 48/1000
aver metric loss3.602e+00, aver reg loss1.404e-04
Total time 19.04281234741211
Epoch 49/1000
aver metric loss3.593e+00, aver reg loss1.423e-04
Total time 18.679785013198853
Epoch 50/1000
{'precision': array([0.02468039, 0.02177054, 0.01845488]), 'recall': array([0.02628748, 0.04619617, 0.07746864]), 'ndcg': array([0.03022065, 0.03725245, 0.04814742])}
Best so far: [0.02626341 0.04612615 0.07736684 0.03051878 0.03753988 0.04841648]
aver metric loss3.570e+00, aver reg loss1.444e-04
Total time 45.59154510498047
Epoch 51/1000
aver metric loss3.565e+00, aver reg loss1.463e-04
Total time 18.58644413948059
Epoch 52/1000
aver metric loss3.550e+00, aver reg loss1.491e-04
Total time 19.016801357269287
Epoch 53/1000
aver metric loss3.583e+00, aver reg loss1.501e-04
Total time 18.900820016860962
Epoch 54/1000
aver metric loss3.578e+00, aver reg loss1.512e-04
Total time 18.77490234375
Epoch 55/1000
aver metric loss3.554e+00, aver reg loss1.534e-04
Total time 19.125916004180908
Epoch 56/1000
aver metric loss3.564e+00, aver reg loss1.553e-04
Total time 18.993084192276
Epoch 57/1000
aver metric loss3.563e+00, aver reg loss1.574e-04
Total time 18.585217475891113
Epoch 58/1000
aver metric loss3.556e+00, aver reg loss1.587e-04
Total time 18.68454599380493
Epoch 59/1000
aver metric loss3.550e+00, aver reg loss1.601e-04
Total time 18.410099983215332
Epoch 60/1000
{'precision': array([0.02462703, 0.02181671, 0.01849593]), 'recall': array([0.02614495, 0.04620328, 0.07775899]), 'ndcg': array([0.03047917, 0.03756428, 0.04851918])}
Best so far: [0.02614495 0.04620328 0.07775899 0.03047917 0.03756428 0.04851918]
aver metric loss3.556e+00, aver reg loss1.621e-04
Total time 43.94929528236389
Epoch 61/1000
aver metric loss3.553e+00, aver reg loss1.631e-04
Total time 18.259569883346558
Epoch 62/1000
aver metric loss3.555e+00, aver reg loss1.645e-04
Total time 18.663223028182983
Epoch 63/1000
aver metric loss3.548e+00, aver reg loss1.668e-04
Total time 19.063684940338135
Epoch 64/1000
aver metric loss3.552e+00, aver reg loss1.680e-04
Total time 18.395548582077026
Epoch 65/1000
aver metric loss3.550e+00, aver reg loss1.694e-04
Total time 18.28628444671631
Epoch 66/1000
aver metric loss3.551e+00, aver reg loss1.710e-04
Total time 19.09661078453064
Epoch 67/1000
aver metric loss3.548e+00, aver reg loss1.724e-04
Total time 17.76116681098938
Epoch 68/1000
aver metric loss3.532e+00, aver reg loss1.741e-04
Total time 18.743313312530518
Epoch 69/1000
aver metric loss3.547e+00, aver reg loss1.749e-04
Total time 19.04901885986328
Epoch 70/1000
{'precision': array([0.02470707, 0.02157764, 0.01845129]), 'recall': array([0.02608672, 0.04562074, 0.07726953]), 'ndcg': array([0.0303513 , 0.03709836, 0.04811359])}
Best so far: [0.02614495 0.04620328 0.07775899 0.03047917 0.03756428 0.04851918]
aver metric loss3.531e+00, aver reg loss1.769e-04
Total time 43.1001136302948
Epoch 71/1000
aver metric loss3.547e+00, aver reg loss1.777e-04
Total time 17.39350128173828
Epoch 72/1000
aver metric loss3.529e+00, aver reg loss1.793e-04
Total time 17.331995725631714
Epoch 73/1000
aver metric loss3.522e+00, aver reg loss1.813e-04
Total time 18.43881130218506
Epoch 74/1000
aver metric loss3.540e+00, aver reg loss1.816e-04
Total time 18.630414247512817
Epoch 75/1000
aver metric loss3.530e+00, aver reg loss1.828e-04
Total time 18.143094778060913
Epoch 76/1000
aver metric loss3.526e+00, aver reg loss1.840e-04
Total time 18.374404191970825
Epoch 77/1000
aver metric loss3.526e+00, aver reg loss1.854e-04
Total time 18.276987552642822
Epoch 78/1000
aver metric loss3.516e+00, aver reg loss1.866e-04
Total time 18.717308521270752
Epoch 79/1000
aver metric loss3.537e+00, aver reg loss1.878e-04
Total time 19.19989776611328
Epoch 80/1000
{'precision': array([0.02473374, 0.02175925, 0.01852414]), 'recall': array([0.02589059, 0.04561598, 0.07745065]), 'ndcg': array([0.03049525, 0.03730288, 0.04831613])}
Best so far: [0.02614495 0.04620328 0.07775899 0.03047917 0.03756428 0.04851918]
aver metric loss3.541e+00, aver reg loss1.886e-04
Total time 41.56888031959534
Epoch 81/1000
aver metric loss3.516e+00, aver reg loss1.901e-04
Total time 18.44508934020996
Epoch 82/1000
aver metric loss3.519e+00, aver reg loss1.909e-04
Total time 18.657559871673584
Epoch 83/1000
aver metric loss3.519e+00, aver reg loss1.933e-04
Total time 18.645880699157715
Epoch 84/1000
aver metric loss3.518e+00, aver reg loss1.929e-04
Total time 18.881232976913452
Epoch 85/1000
aver metric loss3.529e+00, aver reg loss1.940e-04
Total time 19.30527925491333
Epoch 86/1000
aver metric loss3.511e+00, aver reg loss1.956e-04
Total time 19.087558269500732
Epoch 87/1000
aver metric loss3.521e+00, aver reg loss1.967e-04
Total time 19.065937519073486
Epoch 88/1000
aver metric loss3.517e+00, aver reg loss1.971e-04
Total time 19.341136693954468
Epoch 89/1000
aver metric loss3.538e+00, aver reg loss1.989e-04
Total time 18.770044803619385
Epoch 90/1000
{'precision': array([0.02411401, 0.02150171, 0.01835998]), 'recall': array([0.02550148, 0.04539888, 0.07669964]), 'ndcg': array([0.02983107, 0.03686518, 0.04773128])}
Best so far: [0.02614495 0.04620328 0.07775899 0.03047917 0.03756428 0.04851918]
aver metric loss3.548e+00, aver reg loss1.979e-04
Total time 43.79527044296265
Epoch 91/1000
aver metric loss3.521e+00, aver reg loss1.994e-04
Total time 18.20735001564026
Epoch 92/1000
aver metric loss3.507e+00, aver reg loss2.013e-04
Total time 18.705268621444702
Epoch 93/1000
aver metric loss3.508e+00, aver reg loss2.015e-04
Total time 19.11477780342102
Epoch 94/1000
Traceback (most recent call last):
  File "main.py", line 123, in <module>
    output_information = Procedure.Metric_train_original(args, dataset, model, metric, epoch, sampler, w)
  File "/data1/deepdog/project/GFML/MCL/code/Procedure.py", line 34, in Metric_train_original
    metric_loss, reg_loss, pos_loss, neg_loss = metric.stageOne(S, num_items_per_user)
  File "/data1/deepdog/project/GFML/MCL/code/utils.py", line 50, in stageOne
    return metric_loss.cpu().item(), reg_loss.cpu().item(), pos_loss, neg_loss
KeyboardInterrupt