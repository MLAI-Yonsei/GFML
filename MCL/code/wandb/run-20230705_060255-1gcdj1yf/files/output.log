
Epoch 1/1000
aver metric loss3.244e+00, aver reg loss1.165e-06
Total time 15.980870485305786
Epoch 2/1000
aver metric loss3.223e+00, aver reg loss3.041e-06
Total time 15.772158145904541
Epoch 3/1000
aver metric loss3.258e+00, aver reg loss6.300e-06
Total time 15.60908055305481
Epoch 4/1000
aver metric loss3.321e+00, aver reg loss1.087e-05
Total time 15.945571184158325
Epoch 5/1000
aver metric loss3.370e+00, aver reg loss1.647e-05
Total time 15.814120292663574
Epoch 6/1000
aver metric loss3.203e+00, aver reg loss1.195e-05
Total time 15.221499919891357
Epoch 7/1000
aver metric loss3.167e+00, aver reg loss1.258e-05
Total time 15.245633602142334
Epoch 8/1000
aver metric loss3.199e+00, aver reg loss1.459e-05
Total time 16.10016179084778
Epoch 9/1000
aver metric loss3.183e+00, aver reg loss1.591e-05
Total time 16.304133653640747
Epoch 10/1000
{'precision': array([0.02856543, 0.02475289, 0.02081346]), 'recall': array([0.02373204, 0.04004562, 0.06535294]), 'ndcg': array([0.03272974, 0.03784997, 0.04706195])}
Best so far: [0.02373204 0.04004562 0.06535294 0.03272974 0.03784997 0.04706195]
aver metric loss3.195e+00, aver reg loss1.770e-05
Total time 29.972634315490723
Epoch 11/1000
aver metric loss3.090e+00, aver reg loss1.755e-05
Total time 14.001094818115234
Epoch 12/1000
aver metric loss3.105e+00, aver reg loss1.924e-05
Total time 14.821876287460327
Epoch 13/1000
aver metric loss3.113e+00, aver reg loss2.029e-05
Total time 16.410181522369385
Epoch 14/1000
aver metric loss3.113e+00, aver reg loss2.150e-05
Total time 15.542420625686646
Epoch 15/1000
aver metric loss3.109e+00, aver reg loss2.238e-05
Total time 16.26210379600525
Epoch 16/1000
aver metric loss3.052e+00, aver reg loss2.218e-05
Total time 16.426413774490356
Epoch 17/1000
aver metric loss3.053e+00, aver reg loss2.345e-05
Total time 16.508596897125244
Epoch 18/1000
aver metric loss3.049e+00, aver reg loss2.422e-05
Total time 15.09040117263794
Epoch 19/1000
aver metric loss3.056e+00, aver reg loss2.510e-05
Total time 16.089634895324707
Epoch 20/1000
{'precision': array([0.03262604, 0.02850055, 0.02392379]), 'recall': array([0.02620933, 0.04499572, 0.07397088]), 'ndcg': array([0.03722543, 0.04291176, 0.05336233])}
Best so far: [0.02620933 0.04499572 0.07397088 0.03722543 0.04291176 0.05336233]
aver metric loss3.042e+00, aver reg loss2.562e-05
Total time 30.30649971961975
Epoch 21/1000
aver metric loss2.995e+00, aver reg loss2.573e-05
Total time 16.738713264465332
Epoch 22/1000
aver metric loss3.003e+00, aver reg loss2.664e-05
Total time 16.525933027267456
Epoch 23/1000
aver metric loss3.022e+00, aver reg loss2.737e-05
Total time 13.386369705200195
Epoch 24/1000
aver metric loss3.011e+00, aver reg loss2.776e-05
Total time 13.57472276687622
Epoch 25/1000
aver metric loss3.039e+00, aver reg loss2.822e-05
Total time 16.100593328475952
Epoch 26/1000
aver metric loss2.999e+00, aver reg loss2.788e-05
Total time 15.657727003097534
Epoch 27/1000
aver metric loss2.981e+00, aver reg loss2.856e-05
Total time 14.942907810211182
Epoch 28/1000
aver metric loss2.973e+00, aver reg loss2.897e-05
Total time 16.247874975204468
Epoch 29/1000
aver metric loss2.994e+00, aver reg loss2.975e-05
Total time 15.086600065231323
Epoch 30/1000
{'precision': array([0.03370225, 0.02907873, 0.02427966]), 'recall': array([0.02726618, 0.04637937, 0.07542492]), 'ndcg': array([0.03842553, 0.04404608, 0.05448455])}
Best so far: [0.02726618 0.04637937 0.07542492 0.03842553 0.04404608 0.05448455]
aver metric loss2.990e+00, aver reg loss2.974e-05
Total time 30.753522634506226
Epoch 31/1000
aver metric loss2.943e+00, aver reg loss2.961e-05
Total time 15.666896104812622
Epoch 32/1000
aver metric loss2.956e+00, aver reg loss3.029e-05
Total time 15.884797096252441
Epoch 33/1000
aver metric loss2.971e+00, aver reg loss3.092e-05
Total time 15.804076433181763
Epoch 34/1000
aver metric loss2.977e+00, aver reg loss3.112e-05
Total time 16.541950702667236
Epoch 35/1000
aver metric loss2.964e+00, aver reg loss3.067e-05
Total time 15.23244023323059
Epoch 36/1000
aver metric loss2.947e+00, aver reg loss3.061e-05
Total time 13.844590187072754
Epoch 37/1000
aver metric loss2.939e+00, aver reg loss3.145e-05
Total time 15.511896848678589
Epoch 38/1000
aver metric loss2.938e+00, aver reg loss3.213e-05
Total time 15.280237197875977
Epoch 39/1000
aver metric loss2.946e+00, aver reg loss3.204e-05
Total time 16.33096218109131
Epoch 40/1000
{'precision': array([0.03435866, 0.03002137, 0.02514121]), 'recall': array([0.02749488, 0.04693537, 0.07719311]), 'ndcg': array([0.0391648 , 0.04495997, 0.05574707])}
Best so far: [0.02749488 0.04693537 0.07719311 0.0391648  0.04495997 0.05574707]
aver metric loss2.938e+00, aver reg loss3.204e-05
Total time 30.312204837799072
Epoch 41/1000
aver metric loss2.916e+00, aver reg loss3.204e-05
Total time 16.285468578338623
Epoch 42/1000
aver metric loss2.913e+00, aver reg loss3.297e-05
Total time 14.91115427017212
Epoch 43/1000
aver metric loss2.929e+00, aver reg loss3.314e-05
Total time 16.398990392684937
Epoch 44/1000
aver metric loss2.942e+00, aver reg loss3.307e-05
Total time 15.92695140838623
Epoch 45/1000
aver metric loss2.936e+00, aver reg loss3.254e-05
Total time 15.467003345489502
Epoch 46/1000
aver metric loss2.924e+00, aver reg loss3.294e-05
Total time 17.23824644088745
Epoch 47/1000
aver metric loss2.925e+00, aver reg loss3.357e-05
Total time 14.58701753616333
Epoch 48/1000
aver metric loss2.915e+00, aver reg loss3.383e-05
Total time 13.923798322677612
Epoch 49/1000
aver metric loss2.908e+00, aver reg loss3.396e-05
Total time 15.394268035888672
Epoch 50/1000
{'precision': array([0.03509522, 0.03012632, 0.02518986]), 'recall': array([0.02864406, 0.0479147 , 0.0777911 ]), 'ndcg': array([0.04000957, 0.04569292, 0.05644935])}
Best so far: [0.02864406 0.0479147  0.0777911  0.04000957 0.04569292 0.05644935]
aver metric loss2.892e+00, aver reg loss3.360e-05
Total time 31.805713653564453
Epoch 51/1000
aver metric loss2.886e+00, aver reg loss3.390e-05
Total time 15.405680894851685
Epoch 52/1000
aver metric loss2.914e+00, aver reg loss3.458e-05
Total time 16.24159002304077
Epoch 53/1000
aver metric loss2.908e+00, aver reg loss3.464e-05
Total time 15.953402042388916
Epoch 54/1000
aver metric loss2.909e+00, aver reg loss3.497e-05
Total time 16.703407764434814
Epoch 55/1000
aver metric loss2.892e+00, aver reg loss3.466e-05
Total time 15.606407642364502
Epoch 56/1000
aver metric loss2.880e+00, aver reg loss3.477e-05
Total time 16.840582609176636
Epoch 57/1000
aver metric loss2.882e+00, aver reg loss3.539e-05
Total time 16.371297121047974
Epoch 58/1000
aver metric loss2.895e+00, aver reg loss3.567e-05
Total time 16.20632791519165
Epoch 59/1000
aver metric loss2.913e+00, aver reg loss3.569e-05
Total time 14.111762046813965
Epoch 60/1000
{'precision': array([0.03514865, 0.03038202, 0.02548277]), 'recall': array([0.02832718, 0.04798533, 0.07836156]), 'ndcg': array([0.04003283, 0.04581282, 0.05672064])}
Best so far: [0.02832718 0.04798533 0.07836156 0.04003283 0.04581282 0.05672064]
aver metric loss2.904e+00, aver reg loss3.540e-05
Total time 29.16899871826172
Epoch 61/1000
aver metric loss2.880e+00, aver reg loss3.565e-05
Total time 16.61516571044922
Epoch 62/1000
aver metric loss2.894e+00, aver reg loss3.610e-05
Total time 16.048051834106445
Epoch 63/1000
aver metric loss2.887e+00, aver reg loss3.570e-05
Total time 15.99758005142212
Epoch 64/1000
aver metric loss2.887e+00, aver reg loss3.566e-05
Total time 15.920563459396362
Epoch 65/1000
aver metric loss2.871e+00, aver reg loss3.573e-05
Total time 16.173530340194702
Epoch 66/1000
aver metric loss2.851e+00, aver reg loss3.591e-05
Total time 15.935177087783813
Epoch 67/1000
aver metric loss2.871e+00, aver reg loss3.662e-05
Total time 16.255266666412354
Epoch 68/1000
aver metric loss2.875e+00, aver reg loss3.638e-05
Total time 15.252718925476074
Epoch 69/1000
aver metric loss2.880e+00, aver reg loss3.682e-05
Total time 15.259052038192749
Epoch 70/1000
{'precision': array([0.03500363, 0.03033431, 0.02560108]), 'recall': array([0.02829285, 0.04787422, 0.0789674 ]), 'ndcg': array([0.04004757, 0.04585876, 0.05702881])}
Best so far: [0.02829285 0.04787422 0.0789674  0.04004757 0.04585876 0.05702881]
aver metric loss2.864e+00, aver reg loss3.601e-05
Total time 29.566948175430298
Epoch 71/1000
aver metric loss2.859e+00, aver reg loss3.658e-05
Total time 14.633613586425781
Epoch 72/1000
aver metric loss2.849e+00, aver reg loss3.700e-05
Total time 16.50197124481201
Epoch 73/1000
aver metric loss2.862e+00, aver reg loss3.742e-05
Total time 16.341672658920288
Epoch 74/1000
aver metric loss2.860e+00, aver reg loss3.770e-05
Total time 16.74370837211609
Epoch 75/1000
aver metric loss2.850e+00, aver reg loss3.767e-05
Total time 16.479208946228027
Epoch 76/1000
aver metric loss2.839e+00, aver reg loss3.700e-05
Total time 16.084622621536255
Epoch 77/1000
aver metric loss2.846e+00, aver reg loss3.798e-05
Total time 14.79191780090332
Epoch 78/1000
aver metric loss2.858e+00, aver reg loss3.764e-05
Total time 16.304505109786987
Epoch 79/1000
aver metric loss2.845e+00, aver reg loss3.748e-05
Total time 16.29363489151001
Epoch 80/1000
{'precision': array([0.03475938, 0.03054803, 0.02566595]), 'recall': array([0.02823256, 0.04851695, 0.07916834]), 'ndcg': array([0.0398823 , 0.04615137, 0.05720353])}
Best so far: [0.02823256 0.04851695 0.07916834 0.0398823  0.04615137 0.05720353]
Traceback (most recent call last):
  File "main.py", line 123, in <module>
    output_information = Procedure.Metric_train_original(args, dataset, model, metric, epoch, sampler, w)
  File "/data1/deepdog/project/GFML/MCL/code/Procedure.py", line 34, in Metric_train_original
    metric_loss, reg_loss, pos_loss, neg_loss = metric.stageOne(S, num_items_per_user)
  File "/data1/deepdog/project/GFML/MCL/code/utils.py", line 44, in stageOne
    loss.backward()
  File "/data1/deepdog/anaconda3/envs/mcl/lib/python3.7/site-packages/torch/_tensor.py", line 255, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/data1/deepdog/anaconda3/envs/mcl/lib/python3.7/site-packages/torch/autograd/__init__.py", line 149, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt