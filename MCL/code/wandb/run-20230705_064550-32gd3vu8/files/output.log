
Epoch 1/1000
aver metric loss7.520e+00, aver reg loss2.732e-06
Total time 16.090015649795532
Epoch 2/1000
aver metric loss7.466e+00, aver reg loss8.481e-06
Total time 15.883412837982178
Epoch 3/1000
aver metric loss7.483e+00, aver reg loss1.245e-05
Total time 16.05906581878662
Epoch 4/1000
aver metric loss7.543e+00, aver reg loss1.599e-05
Total time 17.016637325286865
Epoch 5/1000
aver metric loss7.507e+00, aver reg loss1.848e-05
Total time 17.665952920913696
Epoch 6/1000
aver metric loss7.350e+00, aver reg loss1.691e-05
Total time 16.78067660331726
Epoch 7/1000
aver metric loss7.325e+00, aver reg loss1.859e-05
Total time 17.009406566619873
Epoch 8/1000
aver metric loss7.349e+00, aver reg loss2.028e-05
Total time 16.47554922103882
Epoch 9/1000
aver metric loss7.327e+00, aver reg loss2.195e-05
Total time 16.712175130844116
Epoch 10/1000
{'precision': array([0.03377476, 0.0287906 , 0.02407167]), 'recall': array([0.02729573, 0.04547405, 0.07404433]), 'ndcg': array([0.03859135, 0.04381995, 0.05417544])}
Best so far: [0.02729573 0.04547405 0.07404433 0.03859135 0.04381995 0.05417544]
aver metric loss7.300e+00, aver reg loss2.334e-05
Total time 31.37360167503357
Epoch 11/1000
aver metric loss7.245e+00, aver reg loss2.445e-05
Total time 15.875952005386353
Epoch 12/1000
aver metric loss7.249e+00, aver reg loss2.600e-05
Total time 14.720978260040283
Epoch 13/1000
aver metric loss7.264e+00, aver reg loss2.710e-05
Total time 16.834160804748535
Epoch 14/1000
aver metric loss7.250e+00, aver reg loss2.830e-05
Total time 16.357552766799927
Epoch 15/1000
aver metric loss7.246e+00, aver reg loss2.896e-05
Total time 17.53526020050049
Epoch 16/1000
aver metric loss7.211e+00, aver reg loss2.981e-05
Total time 17.007378339767456
Epoch 17/1000
aver metric loss7.214e+00, aver reg loss3.104e-05
Total time 17.280441999435425
Epoch 18/1000
aver metric loss7.219e+00, aver reg loss3.212e-05
Total time 17.66145372390747
Epoch 19/1000
aver metric loss7.206e+00, aver reg loss3.298e-05
Total time 16.035433530807495
Epoch 20/1000
{'precision': array([0.04484601, 0.03798229, 0.03114243]), 'recall': array([0.03610495, 0.05964359, 0.0950795 ]), 'ndcg': array([0.0516546 , 0.05818113, 0.07073853])}
Best so far: [0.03610495 0.05964359 0.0950795  0.0516546  0.05818113 0.07073853]
aver metric loss7.194e+00, aver reg loss3.329e-05
Total time 31.61619210243225
Epoch 21/1000
aver metric loss7.171e+00, aver reg loss3.416e-05
Total time 16.705387592315674
Epoch 22/1000
aver metric loss7.173e+00, aver reg loss3.487e-05
Total time 16.166251182556152
Epoch 23/1000
aver metric loss7.183e+00, aver reg loss3.560e-05
Total time 16.2441143989563
Epoch 24/1000
aver metric loss7.189e+00, aver reg loss3.619e-05
Total time 14.488789796829224
Epoch 25/1000
aver metric loss7.178e+00, aver reg loss3.627e-05
Total time 16.290074825286865
Epoch 26/1000
aver metric loss7.177e+00, aver reg loss3.672e-05
Total time 16.97974157333374
Epoch 27/1000
aver metric loss7.160e+00, aver reg loss3.743e-05
Total time 16.4773952960968
Epoch 28/1000
aver metric loss7.152e+00, aver reg loss3.815e-05
Total time 16.474839448928833
Epoch 29/1000
aver metric loss7.156e+00, aver reg loss3.863e-05
Total time 15.200926065444946
Epoch 30/1000
{'precision': array([0.04887227, 0.04112125, 0.03365359]), 'recall': array([0.0389564 , 0.06402409, 0.10187586]), 'ndcg': array([0.05603374, 0.06277781, 0.07610116])}
Best so far: [0.0389564  0.06402409 0.10187586 0.05603374 0.06277781 0.07610116]
aver metric loss7.155e+00, aver reg loss3.881e-05
Total time 30.15116572380066
Epoch 31/1000
aver metric loss7.135e+00, aver reg loss3.926e-05
Total time 16.702866077423096
Epoch 32/1000
aver metric loss7.135e+00, aver reg loss3.992e-05
Total time 15.436610698699951
Epoch 33/1000
aver metric loss7.164e+00, aver reg loss4.020e-05
Total time 15.948004484176636
Epoch 34/1000
aver metric loss7.166e+00, aver reg loss4.060e-05
Total time 15.569354772567749
Epoch 35/1000
aver metric loss7.153e+00, aver reg loss4.042e-05
Total time 17.437780380249023
Epoch 36/1000
aver metric loss7.134e+00, aver reg loss4.072e-05
Total time 14.800129413604736
Epoch 37/1000
aver metric loss7.133e+00, aver reg loss4.139e-05
Total time 15.941981315612793
Epoch 38/1000
aver metric loss7.124e+00, aver reg loss4.205e-05
Total time 15.790095329284668
Epoch 39/1000
aver metric loss7.140e+00, aver reg loss4.229e-05
Total time 17.562003135681152
Epoch 40/1000
{'precision': array([0.05079189, 0.04294928, 0.03505038]), 'recall': array([0.04032229, 0.06684743, 0.10627635]), 'ndcg': array([0.05820632, 0.06537881, 0.07919953])}
Best so far: [0.04032229 0.06684743 0.10627635 0.05820632 0.06537881 0.07919953]
aver metric loss7.128e+00, aver reg loss4.215e-05
Total time 29.857958555221558
Epoch 41/1000
aver metric loss7.121e+00, aver reg loss4.257e-05
Total time 17.43465304374695
Epoch 42/1000
aver metric loss7.109e+00, aver reg loss4.311e-05
Total time 16.975945234298706
Epoch 43/1000
aver metric loss7.125e+00, aver reg loss4.340e-05
Total time 15.800859451293945
Epoch 44/1000
aver metric loss7.134e+00, aver reg loss4.332e-05
Total time 16.196635007858276
Epoch 45/1000
aver metric loss7.142e+00, aver reg loss4.317e-05
Total time 16.810123682022095
Epoch 46/1000
aver metric loss7.133e+00, aver reg loss4.342e-05
Total time 16.147356510162354
Epoch 47/1000
aver metric loss7.127e+00, aver reg loss4.389e-05
Total time 17.248242139816284
Epoch 48/1000
aver metric loss7.121e+00, aver reg loss4.431e-05
Total time 13.352839231491089
Epoch 49/1000
aver metric loss7.118e+00, aver reg loss4.433e-05
Total time 15.558568477630615
Epoch 50/1000
{'precision': array([0.05305499, 0.04424303, 0.0359768 ]), 'recall': array([0.04206446, 0.06854261, 0.1088338 ]), 'ndcg': array([0.06112514, 0.06788112, 0.08190908])}
Best so far: [0.04206446 0.06854261 0.1088338  0.06112514 0.06788112 0.08190908]
aver metric loss7.112e+00, aver reg loss4.432e-05
Total time 31.42982840538025
Epoch 51/1000
aver metric loss7.105e+00, aver reg loss4.474e-05
Total time 17.39788794517517
Epoch 52/1000
aver metric loss7.114e+00, aver reg loss4.497e-05
Total time 18.069355249404907
Epoch 53/1000
aver metric loss7.110e+00, aver reg loss4.521e-05
Total time 17.49237084388733
Epoch 54/1000
aver metric loss7.119e+00, aver reg loss4.522e-05
Total time 16.731563806533813
Epoch 55/1000
aver metric loss7.093e+00, aver reg loss4.543e-05
Total time 16.435307502746582
Epoch 56/1000
aver metric loss7.098e+00, aver reg loss4.561e-05
Total time 17.092689514160156
Epoch 57/1000
aver metric loss7.099e+00, aver reg loss4.596e-05
Total time 15.798868179321289
Epoch 58/1000
aver metric loss7.106e+00, aver reg loss4.624e-05
Total time 17.53838086128235
Epoch 59/1000
aver metric loss7.123e+00, aver reg loss4.612e-05
Total time 16.064857721328735
Epoch 60/1000
{'precision': array([0.05468076, 0.04578102, 0.03697   ]), 'recall': array([0.04345124, 0.07076564, 0.11189055]), 'ndcg': array([0.06312057, 0.07013185, 0.08433648])}
Best so far: [0.04345124 0.07076564 0.11189055 0.06312057 0.07013185 0.08433648]
aver metric loss7.113e+00, aver reg loss4.628e-05
Total time 28.2483811378479
Epoch 61/1000
aver metric loss7.101e+00, aver reg loss4.650e-05
Total time 16.62804913520813
Epoch 62/1000
aver metric loss7.117e+00, aver reg loss4.650e-05
Total time 17.685280323028564
Epoch 63/1000
aver metric loss7.099e+00, aver reg loss4.681e-05
Total time 17.716848611831665
Epoch 64/1000
aver metric loss7.106e+00, aver reg loss4.684e-05
Total time 17.679729223251343
Epoch 65/1000
aver metric loss7.084e+00, aver reg loss4.698e-05
Total time 17.17934274673462
Epoch 66/1000
aver metric loss7.082e+00, aver reg loss4.721e-05
Total time 16.723748207092285
Epoch 67/1000
aver metric loss7.100e+00, aver reg loss4.731e-05
Total time 16.729017972946167
Epoch 68/1000
aver metric loss7.097e+00, aver reg loss4.759e-05
Total time 18.18571972846985
Epoch 69/1000
aver metric loss7.087e+00, aver reg loss4.748e-05
Total time 17.17693829536438
Epoch 70/1000
{'precision': array([0.05442888, 0.04571996, 0.03706732]), 'recall': array([0.0435601 , 0.07125804, 0.1123519 ]), 'ndcg': array([0.06286339, 0.07012841, 0.08444401])}
Best so far: [0.0435601  0.07125804 0.1123519  0.06286339 0.07012841 0.08444401]
aver metric loss7.094e+00, aver reg loss4.757e-05
Total time 29.08675479888916
Epoch 71/1000
aver metric loss7.086e+00, aver reg loss4.803e-05
Total time 14.976772785186768
Epoch 72/1000
aver metric loss7.092e+00, aver reg loss4.814e-05
Total time 16.992160320281982
Epoch 73/1000
aver metric loss7.098e+00, aver reg loss4.822e-05
Total time 17.394753217697144
Epoch 74/1000
aver metric loss7.092e+00, aver reg loss4.841e-05
Total time 17.334728240966797
Epoch 75/1000
aver metric loss7.073e+00, aver reg loss4.856e-05
Total time 18.35209846496582
Epoch 76/1000
aver metric loss7.081e+00, aver reg loss4.878e-05
Total time 17.335292100906372
Epoch 77/1000
aver metric loss7.096e+00, aver reg loss4.882e-05
Total time 17.289467573165894
Epoch 78/1000
aver metric loss7.094e+00, aver reg loss4.879e-05
Total time 16.975902795791626
Epoch 79/1000
aver metric loss7.081e+00, aver reg loss4.880e-05
Total time 16.063326597213745
Epoch 80/1000
{'precision': array([0.05498607, 0.04636683, 0.03740698]), 'recall': array([0.04387515, 0.07207515, 0.11337005]), 'ndcg': array([0.06370309, 0.07117882, 0.08548297])}
Best so far: [0.04387515 0.07207515 0.11337005 0.06370309 0.07117882 0.08548297]
aver metric loss7.090e+00, aver reg loss4.895e-05
Total time 31.479206323623657
Epoch 81/1000
aver metric loss7.072e+00, aver reg loss4.925e-05
Total time 16.758879899978638
Epoch 82/1000
aver metric loss7.079e+00, aver reg loss4.927e-05
Total time 15.743172407150269
Epoch 83/1000
aver metric loss7.080e+00, aver reg loss4.933e-05
Total time 10.734793424606323
Epoch 84/1000
aver metric loss7.086e+00, aver reg loss4.952e-05
Total time 12.114742517471313
Epoch 85/1000
aver metric loss7.070e+00, aver reg loss4.963e-05
Total time 16.919658660888672
Epoch 86/1000
aver metric loss7.077e+00, aver reg loss5.002e-05
Total time 17.07978916168213
Epoch 87/1000
aver metric loss7.075e+00, aver reg loss4.982e-05
Total time 18.052234649658203
Epoch 88/1000
aver metric loss7.079e+00, aver reg loss4.994e-05
Total time 16.922624588012695
Epoch 89/1000
aver metric loss7.082e+00, aver reg loss4.997e-05
Total time 17.7176251411438
Epoch 90/1000
{'precision': array([0.05555089, 0.04637255, 0.0377285 ]), 'recall': array([0.04404099, 0.07182253, 0.11423729]), 'ndcg': array([0.06424038, 0.07127837, 0.08599686])}
Best so far: [0.04404099 0.07182253 0.11423729 0.06424038 0.07127837 0.08599686]
aver metric loss7.074e+00, aver reg loss5.032e-05
Total time 31.099539518356323
Epoch 91/1000
aver metric loss7.074e+00, aver reg loss5.049e-05
Total time 17.086543321609497
Epoch 92/1000
aver metric loss7.081e+00, aver reg loss5.067e-05
Total time 17.117810010910034
Epoch 93/1000
aver metric loss7.067e+00, aver reg loss5.035e-05
Total time 17.83323073387146
Epoch 94/1000
aver metric loss7.079e+00, aver reg loss5.055e-05
Total time 15.10796046257019
Epoch 95/1000
aver metric loss7.077e+00, aver reg loss5.062e-05
Total time 14.367808818817139
Epoch 96/1000
aver metric loss7.069e+00, aver reg loss5.111e-05
Total time 16.38728928565979
Epoch 97/1000
aver metric loss7.075e+00, aver reg loss5.101e-05
Total time 17.541944980621338
Epoch 98/1000
aver metric loss7.059e+00, aver reg loss5.098e-05
Total time 17.30681562423706
Epoch 99/1000
aver metric loss7.065e+00, aver reg loss5.097e-05
Total time 17.59263277053833
Epoch 100/1000
{'precision': array([0.05571881, 0.04684769, 0.03793745]), 'recall': array([0.04433634, 0.07265409, 0.11485238]), 'ndcg': array([0.06429975, 0.07171451, 0.08638952])}
Best so far: [0.04433634 0.07265409 0.11485238 0.06429975 0.07171451 0.08638952]
aver metric loss7.060e+00, aver reg loss5.116e-05
Total time 30.251389265060425
Epoch 101/1000
aver metric loss7.070e+00, aver reg loss5.182e-05
Total time 17.394439458847046
Epoch 102/1000
aver metric loss7.066e+00, aver reg loss5.173e-05
Total time 17.334872245788574
Epoch 103/1000
aver metric loss7.063e+00, aver reg loss5.165e-05
Total time 16.17829656600952
Epoch 104/1000
aver metric loss7.064e+00, aver reg loss5.144e-05
Total time 16.832860708236694
Epoch 105/1000
aver metric loss7.061e+00, aver reg loss5.211e-05
Total time 17.129050493240356
Epoch 106/1000
aver metric loss7.068e+00, aver reg loss5.203e-05
Total time 14.806491613388062
Epoch 107/1000
aver metric loss7.072e+00, aver reg loss5.249e-05
Total time 14.00649356842041
Epoch 108/1000
aver metric loss7.065e+00, aver reg loss5.205e-05
Total time 17.28557586669922
Epoch 109/1000
aver metric loss7.065e+00, aver reg loss5.202e-05
Total time 16.98381209373474
Epoch 110/1000
{'precision': array([0.05518834, 0.04608823, 0.03726005]), 'recall': array([0.04350809, 0.07112431, 0.11227742]), 'ndcg': array([0.06378152, 0.07070331, 0.084927  ])}
Best so far: [0.04433634 0.07265409 0.11485238 0.06429975 0.07171451 0.08638952]
aver metric loss7.057e+00, aver reg loss5.260e-05
Total time 31.78155541419983
Epoch 111/1000
aver metric loss7.063e+00, aver reg loss5.238e-05
Total time 17.04228901863098
Epoch 112/1000
aver metric loss7.071e+00, aver reg loss5.308e-05
Total time 17.68059468269348
Epoch 113/1000
aver metric loss7.066e+00, aver reg loss5.289e-05
Total time 17.730666160583496
Epoch 114/1000
aver metric loss7.050e+00, aver reg loss5.280e-05
Total time 15.543340921401978
Epoch 115/1000
aver metric loss7.062e+00, aver reg loss5.331e-05
Total time 16.440730571746826
Epoch 116/1000
aver metric loss7.063e+00, aver reg loss5.314e-05
Total time 16.40171980857849
Epoch 117/1000
aver metric loss7.051e+00, aver reg loss5.244e-05
Total time 16.639954090118408
Epoch 118/1000
aver metric loss7.053e+00, aver reg loss5.287e-05
Total time 15.238832473754883
Epoch 119/1000
aver metric loss7.056e+00, aver reg loss5.302e-05
Total time 14.139681816101074
Epoch 120/1000
{'precision': array([0.05547075, 0.04699462, 0.0378449 ]), 'recall': array([0.04404984, 0.07307082, 0.11515124]), 'ndcg': array([0.06436516, 0.07213991, 0.08660253])}
Best so far: [0.04404984 0.07307082 0.11515124 0.06436516 0.07213991 0.08660253]
aver metric loss7.046e+00, aver reg loss5.322e-05
Total time 29.518486499786377
Epoch 121/1000
Traceback (most recent call last):
  File "main.py", line 123, in <module>
    output_information = Procedure.Metric_train_original(args, dataset, model, metric, epoch, sampler, w)
  File "/data1/deepdog/project/GFML/MCL/code/Procedure.py", line 34, in Metric_train_original
    metric_loss, reg_loss, pos_loss, neg_loss = metric.stageOne(S, num_items_per_user)
  File "/data1/deepdog/project/GFML/MCL/code/utils.py", line 44, in stageOne
    loss.backward()
  File "/data1/deepdog/anaconda3/envs/mcl/lib/python3.7/site-packages/torch/_tensor.py", line 255, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/data1/deepdog/anaconda3/envs/mcl/lib/python3.7/site-packages/torch/autograd/__init__.py", line 149, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt