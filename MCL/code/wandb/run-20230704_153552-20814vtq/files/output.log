
Epoch 1/1000
aver metric loss7.216e+00, aver reg loss3.304e-07
Total time 20.505361318588257
Epoch 2/1000
aver metric loss7.201e+00, aver reg loss3.297e-07
Total time 17.49056386947632
Epoch 3/1000
aver metric loss7.214e+00, aver reg loss3.293e-07
Total time 16.9825656414032
Epoch 4/1000
aver metric loss7.216e+00, aver reg loss3.289e-07
Total time 18.791709184646606
Epoch 5/1000
aver metric loss7.216e+00, aver reg loss3.285e-07
Total time 20.38651442527771
Epoch 6/1000
aver metric loss7.222e+00, aver reg loss3.278e-07
Total time 19.175637245178223
Epoch 7/1000
aver metric loss7.211e+00, aver reg loss3.274e-07
Total time 19.52509593963623
Epoch 8/1000
aver metric loss7.205e+00, aver reg loss3.270e-07
Total time 19.26109552383423
Epoch 9/1000
aver metric loss7.207e+00, aver reg loss3.268e-07
Total time 18.95533299446106
Epoch 10/1000
{'precision': array([0.00234348, 0.00195666, 0.00154727]), 'recall': array([0.00257082, 0.00433007, 0.0065832 ]), 'ndcg': array([0.00298578, 0.00357821, 0.00436862])}
Best so far: [0.00257082 0.00433007 0.0065832  0.00298578 0.00357821 0.00436862]
aver metric loss7.213e+00, aver reg loss3.268e-07
Total time 47.5001859664917
Epoch 11/1000
aver metric loss7.211e+00, aver reg loss3.262e-07
Total time 20.03048324584961
Epoch 12/1000
aver metric loss7.212e+00, aver reg loss3.260e-07
Total time 18.943815231323242
Epoch 13/1000
aver metric loss7.223e+00, aver reg loss3.259e-07
Total time 19.847010612487793
Epoch 14/1000
aver metric loss7.204e+00, aver reg loss3.259e-07
Total time 19.602259874343872
Epoch 15/1000
aver metric loss7.212e+00, aver reg loss3.258e-07
Total time 19.62397527694702
Epoch 16/1000
aver metric loss7.209e+00, aver reg loss3.254e-07
Total time 19.605281114578247
Epoch 17/1000
aver metric loss7.216e+00, aver reg loss3.256e-07
Total time 18.26196813583374
Epoch 18/1000
aver metric loss7.204e+00, aver reg loss3.255e-07
Total time 19.5456759929657
Epoch 19/1000
aver metric loss7.211e+00, aver reg loss3.256e-07
Total time 18.864853382110596
Epoch 20/1000
{'precision': array([0.00442839, 0.00387741, 0.00314892]), 'recall': array([0.00469837, 0.00821071, 0.0130795 ]), 'ndcg': array([0.0055001 , 0.00674311, 0.00843058])}
Best so far: [0.00469837 0.00821071 0.0130795  0.0055001  0.00674311 0.00843058]
aver metric loss7.217e+00, aver reg loss3.255e-07
Total time 47.142701864242554
Epoch 21/1000
aver metric loss7.209e+00, aver reg loss3.257e-07
Total time 18.526655197143555
Epoch 22/1000
aver metric loss7.209e+00, aver reg loss3.254e-07
Total time 18.94123935699463
Epoch 23/1000
aver metric loss7.215e+00, aver reg loss3.258e-07
Total time 20.617480754852295
Epoch 24/1000
aver metric loss7.218e+00, aver reg loss3.260e-07
Total time 19.94312310218811
Epoch 25/1000
aver metric loss7.211e+00, aver reg loss3.261e-07
Total time 19.606419324874878
Epoch 26/1000
aver metric loss7.211e+00, aver reg loss3.261e-07
Total time 19.239168167114258
Epoch 27/1000
aver metric loss7.216e+00, aver reg loss3.264e-07
Total time 18.690564155578613
Epoch 28/1000
aver metric loss7.212e+00, aver reg loss3.268e-07
Total time 20.62503671646118
Epoch 29/1000
aver metric loss7.213e+00, aver reg loss3.270e-07
Total time 19.665316820144653
Epoch 30/1000
{'precision': array([0.00713509, 0.00597771, 0.00474698]), 'recall': array([0.00663737, 0.0110272 , 0.01757713]), 'ndcg': array([0.00859111, 0.00987197, 0.01195359])}
Best so far: [0.00663737 0.0110272  0.01757713 0.00859111 0.00987197 0.01195359]
aver metric loss7.210e+00, aver reg loss3.272e-07
Total time 46.07606363296509
Epoch 31/1000
aver metric loss7.214e+00, aver reg loss3.277e-07
Total time 19.920937538146973
Epoch 32/1000
aver metric loss7.211e+00, aver reg loss3.279e-07
Total time 19.790542602539062
Epoch 33/1000
aver metric loss7.209e+00, aver reg loss3.282e-07
Total time 19.527207136154175
Epoch 34/1000
aver metric loss7.210e+00, aver reg loss3.287e-07
Total time 19.283712148666382
Epoch 35/1000
aver metric loss7.207e+00, aver reg loss3.291e-07
Total time 18.65682077407837
Epoch 36/1000
aver metric loss7.204e+00, aver reg loss3.295e-07
Total time 19.593985557556152
Epoch 37/1000
aver metric loss7.213e+00, aver reg loss3.301e-07
Total time 19.495869159698486
Epoch 38/1000
aver metric loss7.213e+00, aver reg loss3.308e-07
Total time 19.6207537651062
Epoch 39/1000
aver metric loss7.211e+00, aver reg loss3.312e-07
Total time 19.495251893997192
Epoch 40/1000
{'precision': array([0.00930003, 0.00822987, 0.00671287]), 'recall': array([0.00837714, 0.01473084, 0.02355379]), 'ndcg': array([0.01093536, 0.01298184, 0.01591925])}
Best so far: [0.00837714 0.01473084 0.02355379 0.01093536 0.01298184 0.01591925]
aver metric loss7.214e+00, aver reg loss3.319e-07
Total time 46.625261068344116
Epoch 41/1000
aver metric loss7.214e+00, aver reg loss3.324e-07
Total time 19.101047039031982
Epoch 42/1000
aver metric loss7.214e+00, aver reg loss3.331e-07
Total time 18.549666166305542
Epoch 43/1000
aver metric loss7.210e+00, aver reg loss3.336e-07
Total time 19.001276969909668
Epoch 44/1000
aver metric loss7.206e+00, aver reg loss3.344e-07
Total time 19.716341018676758
Epoch 45/1000
aver metric loss7.209e+00, aver reg loss3.350e-07
Total time 19.90331268310547
Epoch 46/1000
aver metric loss7.210e+00, aver reg loss3.358e-07
Total time 19.436427354812622
Epoch 47/1000
aver metric loss7.218e+00, aver reg loss3.366e-07
Total time 19.502014636993408
Epoch 48/1000
aver metric loss7.211e+00, aver reg loss3.375e-07
Total time 19.874136924743652
Epoch 49/1000
aver metric loss7.201e+00, aver reg loss3.384e-07
Total time 19.88845705986023
Epoch 50/1000
{'precision': array([0.00998543, 0.00890296, 0.00753114]), 'recall': array([0.00924733, 0.01632163, 0.02703229]), 'ndcg': array([0.01168133, 0.01405309, 0.01776374])}
Best so far: [0.00924733 0.01632163 0.02703229 0.01168133 0.01405309 0.01776374]
aver metric loss7.202e+00, aver reg loss3.390e-07
Total time 46.441218852996826
Epoch 51/1000
aver metric loss7.204e+00, aver reg loss3.399e-07
Total time 19.08038830757141
Epoch 52/1000
aver metric loss7.209e+00, aver reg loss3.407e-07
Total time 19.41661548614502
Epoch 53/1000
aver metric loss7.207e+00, aver reg loss3.417e-07
Total time 20.490898370742798
Epoch 54/1000
aver metric loss7.208e+00, aver reg loss3.428e-07
Total time 19.962449550628662
Epoch 55/1000
aver metric loss7.215e+00, aver reg loss3.437e-07
Total time 19.745864152908325
Epoch 56/1000
aver metric loss7.217e+00, aver reg loss3.450e-07
Total time 20.26290488243103
Epoch 57/1000
aver metric loss7.207e+00, aver reg loss3.457e-07
Total time 19.4345440864563
Epoch 58/1000
aver metric loss7.201e+00, aver reg loss3.468e-07
Total time 19.709834814071655
Epoch 59/1000
aver metric loss7.209e+00, aver reg loss3.477e-07
Total time 18.92825746536255
Epoch 60/1000
{'precision': array([0.01029324, 0.00928567, 0.00787743]), 'recall': array([0.0098205 , 0.01735257, 0.02886136]), 'ndcg': array([0.01210566, 0.014759  , 0.01875406])}
Best so far: [0.0098205  0.01735257 0.02886136 0.01210566 0.014759   0.01875406]
aver metric loss7.208e+00, aver reg loss3.490e-07
Total time 46.7383074760437
Epoch 61/1000
aver metric loss7.213e+00, aver reg loss3.501e-07
Total time 20.02400231361389
Epoch 62/1000
aver metric loss7.210e+00, aver reg loss3.513e-07
Total time 19.40535283088684
Epoch 63/1000
aver metric loss7.209e+00, aver reg loss3.524e-07
Total time 19.78473997116089
Epoch 64/1000
aver metric loss7.206e+00, aver reg loss3.535e-07
Total time 19.634384393692017
Epoch 65/1000
aver metric loss7.211e+00, aver reg loss3.548e-07
Total time 20.22125267982483
Epoch 66/1000
aver metric loss7.205e+00, aver reg loss3.560e-07
Total time 18.854103565216064
Epoch 67/1000
aver metric loss7.204e+00, aver reg loss3.571e-07
Total time 19.01679539680481
Epoch 68/1000
aver metric loss7.212e+00, aver reg loss3.586e-07
Total time 17.826520442962646
Epoch 69/1000
aver metric loss7.205e+00, aver reg loss3.597e-07
Total time 20.215796947479248
Epoch 70/1000
{'precision': array([0.01032608, 0.00948062, 0.00802415]), 'recall': array([0.010033  , 0.01800707, 0.02978474]), 'ndcg': array([0.01218086, 0.01511131, 0.01922648])}
Best so far: [0.010033   0.01800707 0.02978474 0.01218086 0.01511131 0.01922648]
aver metric loss7.206e+00, aver reg loss3.612e-07
Total time 47.47940373420715
Epoch 71/1000
aver metric loss7.203e+00, aver reg loss3.625e-07
Total time 19.011045694351196
Epoch 72/1000
aver metric loss7.208e+00, aver reg loss3.640e-07
Total time 19.98461079597473
Epoch 73/1000
aver metric loss7.206e+00, aver reg loss3.652e-07
Total time 18.716227769851685
Epoch 74/1000
aver metric loss7.208e+00, aver reg loss3.666e-07
Total time 18.50029182434082
Epoch 75/1000
aver metric loss7.204e+00, aver reg loss3.680e-07
Total time 15.246284246444702
Epoch 76/1000
aver metric loss7.206e+00, aver reg loss3.693e-07
Total time 14.883659839630127
Epoch 77/1000
aver metric loss7.204e+00, aver reg loss3.709e-07
Total time 20.308701515197754
Epoch 78/1000
aver metric loss7.205e+00, aver reg loss3.727e-07
Total time 20.55315351486206
Epoch 79/1000
aver metric loss7.208e+00, aver reg loss3.741e-07
Total time 19.978416919708252
Epoch 80/1000
{'precision': array([0.01038148, 0.00952679, 0.00806417]), 'recall': array([0.01026757, 0.01843762, 0.03026226]), 'ndcg': array([0.01232093, 0.01534421, 0.01950151])}
Best so far: [0.01026757 0.01843762 0.03026226 0.01232093 0.01534421 0.01950151]
aver metric loss7.206e+00, aver reg loss3.757e-07
Total time 49.642045974731445
Epoch 81/1000
aver metric loss7.207e+00, aver reg loss3.773e-07
Total time 20.196528673171997
Epoch 82/1000
aver metric loss7.206e+00, aver reg loss3.788e-07
Total time 18.716222047805786
Epoch 83/1000
aver metric loss7.204e+00, aver reg loss3.804e-07
Total time 20.02117347717285
Epoch 84/1000
aver metric loss7.205e+00, aver reg loss3.820e-07
Total time 19.457067251205444
Epoch 85/1000
aver metric loss7.204e+00, aver reg loss3.837e-07
Total time 21.013752222061157
Epoch 86/1000
aver metric loss7.206e+00, aver reg loss3.856e-07
Total time 20.097415924072266
Epoch 87/1000
aver metric loss7.202e+00, aver reg loss3.871e-07
Total time 20.929800510406494
Epoch 88/1000
aver metric loss7.208e+00, aver reg loss3.888e-07
Total time 20.428401708602905
Epoch 89/1000
aver metric loss7.204e+00, aver reg loss3.906e-07
Total time 20.361038208007812
Epoch 90/1000
{'precision': array([0.01036917, 0.00947549, 0.00803082]), 'recall': array([0.0104371 , 0.01846426, 0.03053369]), 'ndcg': array([0.01236385, 0.01535226, 0.01958831])}
Best so far: [0.0104371  0.01846426 0.03053369 0.01236385 0.01535226 0.01958831]
aver metric loss7.204e+00, aver reg loss3.921e-07
Total time 45.35018181800842
Epoch 91/1000
aver metric loss7.208e+00, aver reg loss3.942e-07
Total time 19.7414767742157
Epoch 92/1000
aver metric loss7.206e+00, aver reg loss3.960e-07
Total time 20.44417667388916
Epoch 93/1000
aver metric loss7.206e+00, aver reg loss3.977e-07
Total time 21.023188591003418
Epoch 94/1000
aver metric loss7.206e+00, aver reg loss3.996e-07
Total time 20.190950632095337
Epoch 95/1000
aver metric loss7.204e+00, aver reg loss4.014e-07
Total time 19.822959423065186
Epoch 96/1000
aver metric loss7.199e+00, aver reg loss4.033e-07
Total time 20.17778730392456
Epoch 97/1000
aver metric loss7.201e+00, aver reg loss4.052e-07
Total time 20.10788893699646
Epoch 98/1000
aver metric loss7.205e+00, aver reg loss4.073e-07
Total time 20.004873514175415
Epoch 99/1000
aver metric loss7.201e+00, aver reg loss4.091e-07
Total time 19.205822467803955
Epoch 100/1000
{'precision': array([0.01018859, 0.00931337, 0.00790411]), 'recall': array([0.01033662, 0.01833449, 0.03021311]), 'ndcg': array([0.0122181 , 0.01520446, 0.01939978])}
Best so far: [0.0104371  0.01846426 0.03053369 0.01236385 0.01535226 0.01958831]
aver metric loss7.198e+00, aver reg loss4.115e-07
Total time 45.82539248466492
Epoch 101/1000
aver metric loss7.204e+00, aver reg loss4.129e-07
Total time 19.93869948387146
Epoch 102/1000
aver metric loss7.208e+00, aver reg loss4.153e-07
Total time 20.486112117767334
Epoch 103/1000
aver metric loss7.203e+00, aver reg loss4.174e-07
Total time 20.260313034057617
Epoch 104/1000
aver metric loss7.201e+00, aver reg loss4.193e-07
Total time 20.117583513259888
Epoch 105/1000
aver metric loss7.206e+00, aver reg loss4.211e-07
Total time 20.48778247833252
Epoch 106/1000
aver metric loss7.205e+00, aver reg loss4.235e-07
Total time 19.231602430343628
Epoch 107/1000
aver metric loss7.203e+00, aver reg loss4.257e-07
Total time 20.19634199142456
Epoch 108/1000
aver metric loss7.201e+00, aver reg loss4.278e-07
Total time 19.69837522506714
Epoch 109/1000
aver metric loss7.199e+00, aver reg loss4.296e-07
Total time 20.44404625892639
Epoch 110/1000
{'precision': array([0.01016396, 0.00918204, 0.00781894]), 'recall': array([0.01037298, 0.01817988, 0.02994077]), 'ndcg': array([0.0121733 , 0.01505322, 0.01921562])}
Best so far: [0.0104371  0.01846426 0.03053369 0.01236385 0.01535226 0.01958831]
aver metric loss7.199e+00, aver reg loss4.319e-07
Total time 46.76602292060852
Epoch 111/1000
aver metric loss7.202e+00, aver reg loss4.344e-07
Total time 20.682048320770264
Epoch 112/1000
aver metric loss7.204e+00, aver reg loss4.365e-07
Total time 20.486307859420776
Epoch 113/1000
aver metric loss7.199e+00, aver reg loss4.385e-07
Total time 20.44045090675354
Epoch 114/1000
aver metric loss7.201e+00, aver reg loss4.411e-07
Total time 18.827939987182617
Epoch 115/1000
aver metric loss7.199e+00, aver reg loss4.434e-07
Total time 20.9199538230896
Epoch 116/1000
aver metric loss7.204e+00, aver reg loss4.457e-07
Total time 18.770450830459595
Epoch 117/1000
aver metric loss7.201e+00, aver reg loss4.481e-07
Total time 20.541969299316406
Epoch 118/1000
aver metric loss7.199e+00, aver reg loss4.506e-07
Total time 19.94186234474182
Epoch 119/1000
aver metric loss7.199e+00, aver reg loss4.529e-07
Total time 19.74390697479248
Epoch 120/1000
{'precision': array([0.01007983, 0.00905686, 0.00768915]), 'recall': array([0.01035208, 0.01795416, 0.02959181]), 'ndcg': array([0.01209012, 0.01488222, 0.01898579])}
Best so far: [0.0104371  0.01846426 0.03053369 0.01236385 0.01535226 0.01958831]
aver metric loss7.197e+00, aver reg loss4.552e-07
Total time 47.985865116119385
Epoch 121/1000
aver metric loss7.198e+00, aver reg loss4.581e-07
Total time 19.25891613960266
Epoch 122/1000
aver metric loss7.201e+00, aver reg loss4.604e-07
Total time 19.977644443511963
Epoch 123/1000
aver metric loss7.197e+00, aver reg loss4.625e-07
Total time 19.37665557861328
Epoch 124/1000
aver metric loss7.199e+00, aver reg loss4.649e-07
Total time 19.06529474258423
Epoch 125/1000
aver metric loss7.201e+00, aver reg loss4.676e-07
Total time 20.56194519996643
Epoch 126/1000
aver metric loss7.201e+00, aver reg loss4.704e-07
Total time 20.817060947418213
Epoch 127/1000
aver metric loss7.195e+00, aver reg loss4.726e-07
Total time 20.212276697158813
Epoch 128/1000
aver metric loss7.199e+00, aver reg loss4.753e-07
Total time 19.836806058883667
Epoch 129/1000
aver metric loss7.201e+00, aver reg loss4.781e-07
Total time 19.83350920677185
Epoch 130/1000
{'precision': array([0.01000595, 0.00888757, 0.007565  ]), 'recall': array([0.01026635, 0.01760338, 0.02906852]), 'ndcg': array([0.01197138, 0.01463905, 0.0186868 ])}
Best so far: [0.0104371  0.01846426 0.03053369 0.01236385 0.01535226 0.01958831]
aver metric loss7.197e+00, aver reg loss4.803e-07
Total time 43.75795388221741
Epoch 131/1000
aver metric loss7.201e+00, aver reg loss4.831e-07
Total time 20.097477912902832
Epoch 132/1000
aver metric loss7.188e+00, aver reg loss4.854e-07
Total time 18.442418336868286
Epoch 133/1000
aver metric loss7.199e+00, aver reg loss4.887e-07
Total time 20.63201355934143
Epoch 134/1000
aver metric loss7.200e+00, aver reg loss4.912e-07
Total time 18.96487069129944
Epoch 135/1000
aver metric loss7.195e+00, aver reg loss4.939e-07
Total time 18.151951789855957
Epoch 136/1000
Traceback (most recent call last):
  File "main.py", line 123, in <module>
    output_information = Procedure.Metric_train_original(args, dataset, model, metric, epoch, sampler, w)
  File "/data1/deepdog/project/GFML/MCL/code/Procedure.py", line 34, in Metric_train_original
    metric_loss, reg_loss, pos_loss, neg_loss = metric.stageOne(S, num_items_per_user)
  File "/data1/deepdog/project/GFML/MCL/code/utils.py", line 39, in stageOne
    metric_loss, reg_loss, pos_loss, neg_loss = self.model.loss(S, num_items_per_user)
  File "/data1/deepdog/project/GFML/MCL/code/model.py", line 149, in loss
    neg_items = torch.Tensor(S[:, 2:]).long()
KeyboardInterrupt