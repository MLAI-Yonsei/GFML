
Epoch 1/1000
aver metric loss3.695e+00, aver reg loss2.967e-06
Total time 21.921202421188354
Epoch 2/1000
aver metric loss3.693e+00, aver reg loss8.508e-06
Total time 20.49633288383484
Epoch 3/1000
aver metric loss3.807e+00, aver reg loss1.176e-05
Total time 19.961104154586792
Epoch 4/1000
aver metric loss3.714e+00, aver reg loss1.492e-05
Total time 19.623677730560303
Epoch 5/1000
aver metric loss3.702e+00, aver reg loss2.346e-05
Total time 20.003427028656006
Epoch 6/1000
aver metric loss3.616e+00, aver reg loss1.922e-05
Total time 21.6015362739563
Epoch 7/1000
aver metric loss3.603e+00, aver reg loss1.998e-05
Total time 21.443899393081665
Epoch 8/1000
aver metric loss3.602e+00, aver reg loss2.134e-05
Total time 19.32107925415039
Epoch 9/1000
aver metric loss3.618e+00, aver reg loss2.312e-05
Total time 21.193839073181152
Epoch 10/1000
{'precision': array([0.01035686, 0.00957091, 0.0084397 ]), 'recall': array([0.01119563, 0.02053659, 0.03607133]), 'ndcg': array([0.01256146, 0.01607495, 0.02160215])}
Best so far: [0.01119563 0.02053659 0.03607133 0.01256146 0.01607495 0.02160215]
aver metric loss3.592e+00, aver reg loss2.530e-05
Total time 46.17844796180725
Epoch 11/1000
aver metric loss3.396e+00, aver reg loss2.591e-05
Total time 20.428675413131714
Epoch 12/1000
aver metric loss3.389e+00, aver reg loss2.804e-05
Total time 19.758079290390015
Epoch 13/1000
aver metric loss3.459e+00, aver reg loss2.950e-05
Total time 17.728625297546387
Epoch 14/1000
aver metric loss3.435e+00, aver reg loss3.059e-05
Total time 21.07990050315857
Epoch 15/1000
aver metric loss3.442e+00, aver reg loss3.205e-05
Total time 21.66907238960266
Epoch 16/1000
aver metric loss3.286e+00, aver reg loss3.415e-05
Total time 20.037431716918945
Epoch 17/1000
aver metric loss3.292e+00, aver reg loss3.639e-05
Total time 21.86022663116455
Epoch 18/1000
aver metric loss3.308e+00, aver reg loss3.825e-05
Total time 21.1461238861084
Epoch 19/1000
aver metric loss3.358e+00, aver reg loss3.978e-05
Total time 20.0331928730011
Epoch 20/1000
{'precision': array([0.01580719, 0.0142435 , 0.01242587]), 'recall': array([0.01708684, 0.03067933, 0.05308227]), 'ndcg': array([0.01970151, 0.02464742, 0.03256217])}
Best so far: [0.01708684 0.03067933 0.05308227 0.01970151 0.02464742 0.03256217]
aver metric loss3.354e+00, aver reg loss4.118e-05
Total time 51.68711709976196
Epoch 21/1000
aver metric loss3.220e+00, aver reg loss4.351e-05
Total time 22.51323890686035
Epoch 22/1000
aver metric loss3.229e+00, aver reg loss4.559e-05
Total time 20.520583152770996
Epoch 23/1000
aver metric loss3.246e+00, aver reg loss4.736e-05
Total time 22.10992980003357
Epoch 24/1000
aver metric loss3.291e+00, aver reg loss4.874e-05
Total time 23.25304651260376
Epoch 25/1000
aver metric loss3.297e+00, aver reg loss4.975e-05
Total time 22.629425048828125
Epoch 26/1000
aver metric loss3.169e+00, aver reg loss5.224e-05
Total time 21.67700171470642
Epoch 27/1000
aver metric loss3.185e+00, aver reg loss5.460e-05
Total time 20.405598402023315
Epoch 28/1000
aver metric loss3.234e+00, aver reg loss5.596e-05
Total time 19.04405903816223
Epoch 29/1000
aver metric loss3.265e+00, aver reg loss5.638e-05
Total time 20.082258939743042
Epoch 30/1000
{'precision': array([0.01600008, 0.01450617, 0.01255977]), 'recall': array([0.01715691, 0.03123164, 0.05355528]), 'ndcg': array([0.01959553, 0.02474396, 0.03262011])}
Best so far: [0.01715691 0.03123164 0.05355528 0.01959553 0.02474396 0.03262011]
aver metric loss3.294e+00, aver reg loss5.735e-05
Total time 52.271876096725464
Epoch 31/1000
aver metric loss3.154e+00, aver reg loss6.027e-05
Total time 22.271515369415283
Epoch 32/1000
aver metric loss3.168e+00, aver reg loss6.120e-05
Total time 19.53861165046692
Epoch 33/1000
aver metric loss3.181e+00, aver reg loss6.302e-05
Total time 22.808088302612305
Epoch 34/1000
aver metric loss3.225e+00, aver reg loss6.378e-05
Total time 21.345439910888672
Epoch 35/1000
aver metric loss3.268e+00, aver reg loss6.448e-05
Total time 19.734037399291992
Epoch 36/1000
aver metric loss3.113e+00, aver reg loss6.616e-05
Total time 19.82329034805298
Epoch 37/1000
aver metric loss3.190e+00, aver reg loss6.852e-05
Total time 19.89893341064453
Epoch 38/1000
aver metric loss3.189e+00, aver reg loss6.880e-05
Total time 18.352442979812622
Epoch 39/1000
Traceback (most recent call last):
  File "main.py", line 123, in <module>
    output_information = Procedure.Metric_train_original(args, dataset, model, metric, epoch, sampler, w)
  File "/data1/deepdog/project/GFML/MCL/code/Procedure.py", line 34, in Metric_train_original
    metric_loss, reg_loss, pos_loss, neg_loss = metric.stageOne(S, num_items_per_user)
  File "/data1/deepdog/project/GFML/MCL/code/utils.py", line 39, in stageOne
    metric_loss, reg_loss, pos_loss, neg_loss = self.model.loss(S, num_items_per_user)
  File "/data1/deepdog/project/GFML/MCL/code/model.py", line 152, in loss
    neg_items = torch.Tensor(S[:, 2:]).long()
KeyboardInterrupt