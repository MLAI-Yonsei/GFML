Epoch 1/1000
aver metric loss2.789e+00, aver reg loss1.893e-06
Total time 1.6790828704833984
Epoch 2/1000
aver metric loss2.800e+00, aver reg loss1.893e-06
Total time 1.2736594676971436
Epoch 3/1000
aver metric loss2.802e+00, aver reg loss1.893e-06
Total time 1.3835525512695312
Epoch 4/1000
aver metric loss2.803e+00, aver reg loss1.893e-06
Total time 1.3420460224151611
Epoch 5/1000
aver metric loss2.793e+00, aver reg loss1.893e-06
Total time 1.2441906929016113
Epoch 6/1000
aver metric loss2.800e+00, aver reg loss1.892e-06
Total time 1.3753852844238281
Epoch 7/1000
aver metric loss2.804e+00, aver reg loss1.894e-06
Total time 1.1847751140594482
Epoch 8/1000
aver metric loss2.792e+00, aver reg loss1.895e-06
Total time 1.3589954376220703
Epoch 9/1000
aver metric loss2.802e+00, aver reg loss1.895e-06
Total time 1.1325531005859375
Epoch 10/1000
{'precision': array([0.00024577, 0.00031404, 0.00032769]), 'recall': array([0.00040658, 0.00135023, 0.00333718]), 'ndcg': array([0.00034348, 0.00068126, 0.00124629])}
Best so far: [0.00040658 0.00135023 0.00333718 0.00034348 0.00068126 0.00124629]
aver metric loss2.800e+00, aver reg loss1.895e-06
Total time 2.955596923828125
Epoch 11/1000
aver metric loss2.793e+00, aver reg loss1.895e-06
Total time 1.3061459064483643
Epoch 12/1000
aver metric loss2.798e+00, aver reg loss1.897e-06
Total time 1.1123435497283936
Epoch 13/1000
aver metric loss2.801e+00, aver reg loss1.894e-06
Total time 1.0581939220428467
Epoch 14/1000
aver metric loss2.799e+00, aver reg loss1.895e-06
Total time 1.1247179508209229
Epoch 15/1000
aver metric loss2.801e+00, aver reg loss1.896e-06
Total time 1.1478872299194336
Epoch 16/1000
aver metric loss2.797e+00, aver reg loss1.897e-06
Total time 1.129288673400879
Epoch 17/1000
aver metric loss2.805e+00, aver reg loss1.897e-06
Total time 1.1112542152404785
Epoch 18/1000
aver metric loss2.802e+00, aver reg loss1.897e-06
Total time 1.128251314163208
Epoch 19/1000
aver metric loss2.793e+00, aver reg loss1.898e-06
Total time 1.1188249588012695
Epoch 20/1000
{'precision': array([0.00021846, 0.00039596, 0.00038913]), 'recall': array([0.00037244, 0.00185315, 0.0041382 ]), 'ndcg': array([0.00034351, 0.00086987, 0.00150737])}
Best so far: [0.00037244 0.00185315 0.0041382  0.00034351 0.00086987 0.00150737]
aver metric loss2.796e+00, aver reg loss1.897e-06
Total time 2.9231250286102295
Epoch 21/1000
aver metric loss2.803e+00, aver reg loss1.900e-06
Total time 1.2020230293273926
Epoch 22/1000
aver metric loss2.794e+00, aver reg loss1.898e-06
Total time 1.058225393295288
Epoch 23/1000
aver metric loss2.799e+00, aver reg loss1.897e-06
Total time 1.0990357398986816
Epoch 24/1000
aver metric loss2.799e+00, aver reg loss1.898e-06
Total time 1.1443994045257568
Epoch 25/1000
aver metric loss2.795e+00, aver reg loss1.898e-06
Total time 1.113074541091919
Epoch 26/1000
aver metric loss2.791e+00, aver reg loss1.898e-06
Total time 1.1229677200317383
Epoch 27/1000
aver metric loss2.796e+00, aver reg loss1.897e-06
Total time 1.158421277999878
Epoch 28/1000
aver metric loss2.799e+00, aver reg loss1.899e-06
Total time 1.1961085796356201
Epoch 29/1000
aver metric loss2.801e+00, aver reg loss1.903e-06
Total time 1.2708532810211182
Epoch 30/1000
{'precision': array([0.00027307, 0.00045057, 0.0004574 ]), 'recall': array([0.00056132, 0.00224   , 0.00501984]), 'ndcg': array([0.0004298 , 0.00102952, 0.00180388])}
Best so far: [0.00056132 0.00224    0.00501984 0.0004298  0.00102952 0.00180388]
aver metric loss2.805e+00, aver reg loss1.902e-06
Total time 3.1013801097869873
Epoch 31/1000
aver metric loss2.808e+00, aver reg loss1.902e-06
Total time 1.3193743228912354
Epoch 32/1000
aver metric loss2.800e+00, aver reg loss1.900e-06
Total time 1.413799524307251
Epoch 33/1000
aver metric loss2.798e+00, aver reg loss1.899e-06
Total time 1.3000316619873047
Epoch 34/1000
aver metric loss2.794e+00, aver reg loss1.902e-06
Total time 1.2348780632019043
Epoch 35/1000
aver metric loss2.794e+00, aver reg loss1.902e-06
Total time 1.2448489665985107
Epoch 36/1000
aver metric loss2.796e+00, aver reg loss1.902e-06
Total time 1.349165439605713
Epoch 37/1000
aver metric loss2.797e+00, aver reg loss1.903e-06
Total time 1.2914915084838867
Epoch 38/1000
aver metric loss2.794e+00, aver reg loss1.903e-06
Total time 1.2101771831512451
Epoch 39/1000
aver metric loss2.795e+00, aver reg loss1.902e-06
Total time 1.289851427078247
Epoch 40/1000
{'precision': array([0.000355  , 0.0005325 , 0.00052567]), 'recall': array([0.0008617 , 0.00272926, 0.00579355]), 'ndcg': array([0.00065689, 0.00134017, 0.00220439])}
Best so far: [0.0008617  0.00272926 0.00579355 0.00065689 0.00134017 0.00220439]
aver metric loss2.800e+00, aver reg loss1.902e-06
Total time 3.015352964401245
Epoch 41/1000
aver metric loss2.799e+00, aver reg loss1.903e-06
Total time 1.3195629119873047
Epoch 42/1000
aver metric loss2.798e+00, aver reg loss1.904e-06
Total time 1.162200689315796
Epoch 43/1000
aver metric loss2.799e+00, aver reg loss1.905e-06
Total time 1.3190383911132812
Epoch 44/1000
aver metric loss2.795e+00, aver reg loss1.905e-06
Total time 1.2956743240356445
Epoch 45/1000
aver metric loss2.797e+00, aver reg loss1.904e-06
Total time 1.3708713054656982
Epoch 46/1000
aver metric loss2.797e+00, aver reg loss1.906e-06
Total time 1.3462769985198975
Epoch 47/1000
aver metric loss2.801e+00, aver reg loss1.905e-06
Total time 1.3401014804840088
Epoch 48/1000
aver metric loss2.801e+00, aver reg loss1.905e-06
Total time 1.381340742111206
Epoch 49/1000
aver metric loss2.796e+00, aver reg loss1.905e-06
Total time 1.3006763458251953
Epoch 50/1000
{'precision': array([0.00043692, 0.00061442, 0.00060759]), 'recall': array([0.00100052, 0.00314473, 0.00690861]), 'ndcg': array([0.00079754, 0.00159053, 0.00263058])}
Best so far: [0.00100052 0.00314473 0.00690861 0.00079754 0.00159053 0.00263058]
aver metric loss2.801e+00, aver reg loss1.906e-06
Total time 3.0929198265075684
Epoch 51/1000
aver metric loss2.795e+00, aver reg loss1.907e-06
Total time 1.3819153308868408
Epoch 52/1000
aver metric loss2.800e+00, aver reg loss1.907e-06
Total time 1.424147129058838
Epoch 53/1000
aver metric loss2.793e+00, aver reg loss1.907e-06
Total time 1.2896924018859863
Epoch 54/1000
aver metric loss2.795e+00, aver reg loss1.908e-06
Total time 1.252134084701538
Epoch 55/1000
aver metric loss2.793e+00, aver reg loss1.908e-06
Total time 1.4315555095672607
Epoch 56/1000
aver metric loss2.796e+00, aver reg loss1.909e-06
Total time 1.258185863494873
Epoch 57/1000
aver metric loss2.794e+00, aver reg loss1.909e-06
Total time 1.2839531898498535
Epoch 58/1000
aver metric loss2.800e+00, aver reg loss1.909e-06
Total time 1.4345901012420654
Epoch 59/1000
aver metric loss2.802e+00, aver reg loss1.909e-06
Total time 1.3972053527832031
Epoch 60/1000
{'precision': array([0.00070999, 0.0007373 , 0.0007373 ]), 'recall': array([0.0020382 , 0.003502  , 0.00842889]), 'ndcg': array([0.00131153, 0.00188442, 0.00323206])}
Best so far: [0.0020382  0.003502   0.00842889 0.00131153 0.00188442 0.00323206]
aver metric loss2.796e+00, aver reg loss1.909e-06
Total time 3.2452235221862793
Epoch 61/1000
aver metric loss2.795e+00, aver reg loss1.910e-06
Total time 1.4986698627471924
Epoch 62/1000
aver metric loss2.800e+00, aver reg loss1.909e-06
Total time 1.5382919311523438
Epoch 63/1000
aver metric loss2.797e+00, aver reg loss1.911e-06
Total time 1.3283329010009766
Epoch 64/1000
aver metric loss2.796e+00, aver reg loss1.911e-06
Total time 1.3456740379333496
Epoch 65/1000
aver metric loss2.801e+00, aver reg loss1.913e-06
Total time 1.1546506881713867
Epoch 66/1000
aver metric loss2.795e+00, aver reg loss1.913e-06
Total time 1.2488844394683838
Epoch 67/1000
aver metric loss2.801e+00, aver reg loss1.914e-06
Total time 1.2219698429107666
Epoch 68/1000
aver metric loss2.805e+00, aver reg loss1.912e-06
Total time 1.222890853881836
Epoch 69/1000
aver metric loss2.797e+00, aver reg loss1.913e-06
Total time 1.1570441722869873
Epoch 70/1000
{'precision': array([0.00084653, 0.00092845, 0.00093528]), 'recall': array([0.00236703, 0.00468987, 0.01072076]), 'ndcg': array([0.00153476, 0.00240603, 0.00404164])}
Best so far: [0.00236703 0.00468987 0.01072076 0.00153476 0.00240603 0.00404164]
aver metric loss2.799e+00, aver reg loss1.913e-06
Total time 2.8369288444519043
Epoch 71/1000
aver metric loss2.800e+00, aver reg loss1.913e-06
Total time 1.1790657043457031
Epoch 72/1000
aver metric loss2.799e+00, aver reg loss1.913e-06
Total time 1.5759551525115967
Epoch 73/1000
aver metric loss2.796e+00, aver reg loss1.915e-06
Total time 1.2697618007659912
Epoch 74/1000
aver metric loss2.791e+00, aver reg loss1.915e-06
Total time 1.21671724319458
Epoch 75/1000
Traceback (most recent call last):
  File "main.py", line 123, in <module>
    output_information = Procedure.Metric_train_original(args, dataset, model, metric, epoch, sampler, w)
  File "/data1/deepdog/project/GFML/MCL/code/Procedure.py", line 34, in Metric_train_original
    metric_loss, reg_loss, pos_loss, neg_loss = metric.stageOne(S, num_items_per_user)
  File "/data1/deepdog/project/GFML/MCL/code/utils.py", line 39, in stageOne
    metric_loss, reg_loss, pos_loss, neg_loss = self.model.loss(S, num_items_per_user)
  File "/data1/deepdog/project/GFML/MCL/code/model.py", line 205, in loss
    min_neg_length = min_neg_per_item[start_idx: start_idx + i].min()
KeyboardInterrupt