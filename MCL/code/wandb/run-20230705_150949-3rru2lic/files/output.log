
Epoch 1/1000
aver metric loss2.847e+00, aver reg loss5.139e-06
Total time 17.48928451538086
Epoch 2/1000
aver metric loss2.329e+00, aver reg loss2.226e-05
Total time 18.801714181900024
Epoch 3/1000
aver metric loss2.572e+00, aver reg loss3.408e-05
Total time 17.99502158164978
Epoch 4/1000
aver metric loss2.244e+00, aver reg loss3.893e-05
Total time 19.10525631904602
Epoch 5/1000
aver metric loss2.164e+00, aver reg loss4.303e-05
Total time 18.857537031173706
Epoch 6/1000
aver metric loss1.834e+00, aver reg loss4.537e-05
Total time 18.074873447418213
Epoch 7/1000
aver metric loss1.682e+00, aver reg loss4.987e-05
Total time 18.42286968231201
Epoch 8/1000
aver metric loss1.673e+00, aver reg loss5.439e-05
Total time 18.667887687683105
Epoch 9/1000
aver metric loss1.723e+00, aver reg loss5.827e-05
Total time 17.888296365737915
Epoch 10/1000
{'precision': array([0.01775872, 0.01587285, 0.0137274 ]), 'recall': array([0.01859701, 0.03289356, 0.05609864]), 'ndcg': array([0.02183894, 0.02691994, 0.03514917])}
Best so far: [0.01859701 0.03289356 0.05609864 0.02183894 0.02691994 0.03514917]
aver metric loss1.737e+00, aver reg loss6.140e-05
Total time 42.28463315963745
Epoch 11/1000
aver metric loss1.394e+00, aver reg loss6.645e-05
Total time 18.261240005493164
Epoch 12/1000
aver metric loss1.406e+00, aver reg loss7.115e-05
Total time 18.313055753707886
Epoch 13/1000
aver metric loss1.578e+00, aver reg loss7.438e-05
Total time 19.665339946746826
Epoch 14/1000
aver metric loss1.493e+00, aver reg loss7.676e-05
Total time 18.582539558410645
Epoch 15/1000
aver metric loss1.528e+00, aver reg loss7.952e-05
Total time 18.981513500213623
Epoch 16/1000
aver metric loss1.239e+00, aver reg loss8.541e-05
Total time 18.647515535354614
Epoch 17/1000
aver metric loss1.258e+00, aver reg loss8.974e-05
Total time 17.952769994735718
Epoch 18/1000
aver metric loss1.277e+00, aver reg loss9.329e-05
Total time 13.066918849945068
Epoch 19/1000
aver metric loss1.358e+00, aver reg loss9.598e-05
Total time 17.274139642715454
Epoch 20/1000
{'precision': array([0.02043258, 0.0183097 , 0.01576153]), 'recall': array([0.02162802, 0.03823618, 0.06508663]), 'ndcg': array([0.02529059, 0.03126068, 0.04072273])}
Best so far: [0.02162802 0.03823618 0.06508663 0.02529059 0.03126068 0.04072273]
aver metric loss1.362e+00, aver reg loss9.917e-05
Total time 44.203654289245605
Epoch 21/1000
aver metric loss1.133e+00, aver reg loss1.055e-04
Total time 18.86481809616089
Epoch 22/1000
aver metric loss1.136e+00, aver reg loss1.094e-04
Total time 19.078745365142822
Epoch 23/1000
aver metric loss1.168e+00, aver reg loss1.128e-04
Total time 18.93877673149109
Epoch 24/1000
aver metric loss1.220e+00, aver reg loss1.152e-04
Total time 18.62021541595459
Epoch 25/1000
aver metric loss1.202e+00, aver reg loss1.184e-04
Total time 18.70380449295044
Epoch 26/1000
aver metric loss1.026e+00, aver reg loss1.249e-04
Total time 17.37107539176941
Epoch 27/1000
aver metric loss1.037e+00, aver reg loss1.292e-04
Total time 19.178035020828247
Epoch 28/1000
aver metric loss1.105e+00, aver reg loss1.323e-04
Total time 19.48128366470337
Epoch 29/1000
aver metric loss1.156e+00, aver reg loss1.336e-04
Total time 19.44728922843933
Epoch 30/1000
{'precision': array([0.02194907, 0.01928854, 0.01655774]), 'recall': array([0.02334602, 0.04095919, 0.06956375]), 'ndcg': array([0.02711336, 0.03327526, 0.04331813])}
Best so far: [0.02334602 0.04095919 0.06956375 0.02711336 0.03327526 0.04331813]
aver metric loss1.110e+00, aver reg loss1.367e-04
Total time 43.98280668258667
Epoch 31/1000
aver metric loss9.740e-01, aver reg loss1.435e-04
Total time 18.388364553451538
Epoch 32/1000
aver metric loss1.001e+00, aver reg loss1.474e-04
Total time 18.75288200378418
Epoch 33/1000
aver metric loss1.043e+00, aver reg loss1.502e-04
Total time 18.76933264732361
Epoch 34/1000
aver metric loss1.079e+00, aver reg loss1.521e-04
Total time 18.215147018432617
Epoch 35/1000
aver metric loss1.054e+00, aver reg loss1.552e-04
Total time 19.100779056549072
Epoch 36/1000
aver metric loss9.054e-01, aver reg loss1.620e-04
Total time 19.114588022232056
Epoch 37/1000
aver metric loss9.339e-01, aver reg loss1.657e-04
Total time 19.14200758934021
Epoch 38/1000
aver metric loss9.876e-01, aver reg loss1.676e-04
Total time 18.43879508972168
Epoch 39/1000
aver metric loss1.034e+00, aver reg loss1.698e-04
Total time 18.527493000030518
Epoch 40/1000
{'precision': array([0.02224046, 0.01972564, 0.01682656]), 'recall': array([0.02373466, 0.04193043, 0.0707764 ]), 'ndcg': array([0.02754544, 0.03404345, 0.04413505])}
Best so far: [0.02373466 0.04193043 0.0707764  0.02754544 0.03404345 0.04413505]
aver metric loss1.011e+00, aver reg loss1.729e-04
Total time 42.826287031173706
Epoch 41/1000
aver metric loss9.078e-01, aver reg loss1.789e-04
Total time 18.616492986679077
Epoch 42/1000
aver metric loss8.854e-01, aver reg loss1.828e-04
Total time 18.027074813842773
Epoch 43/1000
aver metric loss9.205e-01, aver reg loss1.849e-04
Total time 17.23726773262024
Epoch 44/1000
aver metric loss9.742e-01, aver reg loss1.869e-04
Total time 17.48034381866455
Epoch 45/1000
aver metric loss9.592e-01, aver reg loss1.892e-04
Total time 16.746519804000854
Epoch 46/1000
Traceback (most recent call last):
  File "main.py", line 123, in <module>
    output_information = Procedure.Metric_train_original(args, dataset, model, metric, epoch, sampler, w)
  File "/data1/deepdog/project/GFML/MCL/code/Procedure.py", line 34, in Metric_train_original
    metric_loss, reg_loss, pos_loss, neg_loss = metric.stageOne(S, num_items_per_user)
  File "/data1/deepdog/project/GFML/MCL/code/utils.py", line 44, in stageOne
    loss.backward()
  File "/data1/deepdog/anaconda3/envs/mcl/lib/python3.7/site-packages/torch/_tensor.py", line 255, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/data1/deepdog/anaconda3/envs/mcl/lib/python3.7/site-packages/torch/autograd/__init__.py", line 149, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt