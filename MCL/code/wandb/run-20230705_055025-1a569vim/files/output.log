
Epoch 1/1000
aver metric loss3.581e+00, aver reg loss3.264e-05
Total time 14.854132413864136
Epoch 2/1000
aver metric loss3.682e+00, aver reg loss5.169e-05
Total time 14.973684787750244
Epoch 3/1000
aver metric loss5.562e+00, aver reg loss8.952e-05
Total time 15.518399953842163
Epoch 4/1000
aver metric lossnan, aver reg lossnan
Total time 15.58514928817749
Epoch 5/1000
aver metric lossnan, aver reg lossnan
Total time 16.81649422645569
Epoch 6/1000
aver metric lossnan, aver reg lossnan
Total time 15.35206651687622
Epoch 7/1000
aver metric lossnan, aver reg lossnan
Total time 15.915029287338257
Epoch 8/1000
aver metric lossnan, aver reg lossnan
Total time 16.001710891723633
Epoch 9/1000
aver metric lossnan, aver reg lossnan
Total time 15.971947193145752
Epoch 10/1000
{'precision': array([9.92252795e-05, 9.54089226e-05, 1.57424722e-04]), 'recall': array([6.60051720e-05, 1.34619947e-04, 3.86443651e-04]), 'ndcg': array([0.00011485, 0.00013645, 0.00025942])}
Best so far: [6.60051720e-05 1.34619947e-04 3.86443651e-04 1.14854729e-04
 1.36445459e-04 2.59421032e-04]
aver metric lossnan, aver reg lossnan
Total time 30.331976175308228
Epoch 11/1000
aver metric lossnan, aver reg lossnan
Total time 14.21805191040039
Epoch 12/1000
aver metric lossnan, aver reg lossnan
Total time 13.051728963851929
Epoch 13/1000
aver metric lossnan, aver reg lossnan
Total time 16.815938711166382
Epoch 14/1000
aver metric lossnan, aver reg lossnan
Total time 16.08124279975891
Epoch 15/1000
aver metric lossnan, aver reg lossnan
Total time 14.373350381851196
Epoch 16/1000
aver metric lossnan, aver reg lossnan
Total time 16.545430898666382
Epoch 17/1000
aver metric lossnan, aver reg lossnan
Total time 15.665590286254883
Epoch 18/1000
aver metric lossnan, aver reg lossnan
Total time 17.28085947036743
Epoch 19/1000
aver metric lossnan, aver reg lossnan
Total time 15.46614122390747
Epoch 20/1000
{'precision': array([9.92252795e-05, 9.54089226e-05, 1.57424722e-04]), 'recall': array([6.60051720e-05, 1.34619947e-04, 3.86443651e-04]), 'ndcg': array([0.00011485, 0.00013645, 0.00025942])}
Best so far: [6.60051720e-05 1.34619947e-04 3.86443651e-04 1.14854729e-04
 1.36445459e-04 2.59421032e-04]
aver metric lossnan, aver reg lossnan
Total time 31.80505657196045
Epoch 21/1000
aver metric lossnan, aver reg lossnan
Total time 15.917196035385132
Epoch 22/1000
aver metric lossnan, aver reg lossnan
Total time 15.754652738571167
Epoch 23/1000
aver metric lossnan, aver reg lossnan
Total time 14.115586042404175
Epoch 24/1000
aver metric lossnan, aver reg lossnan
Total time 14.117353916168213
Epoch 25/1000
aver metric lossnan, aver reg lossnan
Total time 16.393432140350342
Epoch 26/1000
aver metric lossnan, aver reg lossnan
Total time 16.9160373210907
Epoch 27/1000
aver metric lossnan, aver reg lossnan
Total time 16.228811979293823
Epoch 28/1000
aver metric lossnan, aver reg lossnan
Total time 15.706264019012451
Epoch 29/1000
aver metric lossnan, aver reg lossnan
Total time 16.44989323616028
Epoch 30/1000
{'precision': array([9.92252795e-05, 9.54089226e-05, 1.57424722e-04]), 'recall': array([6.60051720e-05, 1.34619947e-04, 3.86443651e-04]), 'ndcg': array([0.00011485, 0.00013645, 0.00025942])}
Best so far: [6.60051720e-05 1.34619947e-04 3.86443651e-04 1.14854729e-04
 1.36445459e-04 2.59421032e-04]
aver metric lossnan, aver reg lossnan
Total time 31.874194145202637
Epoch 31/1000
aver metric lossnan, aver reg lossnan
Total time 15.822520971298218
Epoch 32/1000
aver metric lossnan, aver reg lossnan
Total time 17.049463748931885
Epoch 33/1000
aver metric lossnan, aver reg lossnan
Total time 15.441559076309204
Epoch 34/1000
aver metric lossnan, aver reg lossnan
Total time 15.230210781097412
Epoch 35/1000
aver metric lossnan, aver reg lossnan
Total time 13.990622282028198
Epoch 36/1000
aver metric lossnan, aver reg lossnan
Total time 15.876293182373047
Epoch 37/1000
aver metric lossnan, aver reg lossnan
Total time 15.772783279418945
Epoch 38/1000
aver metric lossnan, aver reg lossnan
Total time 14.975356340408325
Epoch 39/1000
aver metric lossnan, aver reg lossnan
Total time 16.65358877182007
Epoch 40/1000
{'precision': array([9.92252795e-05, 9.54089226e-05, 1.57424722e-04]), 'recall': array([6.60051720e-05, 1.34619947e-04, 3.86443651e-04]), 'ndcg': array([0.00011485, 0.00013645, 0.00025942])}
Best so far: [6.60051720e-05 1.34619947e-04 3.86443651e-04 1.14854729e-04
 1.36445459e-04 2.59421032e-04]
aver metric lossnan, aver reg lossnan
Total time 35.41990542411804
Epoch 41/1000
aver metric lossnan, aver reg lossnan
Total time 17.090948820114136
Epoch 42/1000
Process Process-4:
Process Process-2:
Process Process-3:
Process Process-5:
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
  File "/data1/deepdog/anaconda3/envs/mcl/lib/python3.7/multiprocessing/process.py", line 297, in _bootstrap
    self.run()
  File "/data1/deepdog/anaconda3/envs/mcl/lib/python3.7/multiprocessing/process.py", line 297, in _bootstrap
    self.run()
  File "/data1/deepdog/anaconda3/envs/mcl/lib/python3.7/multiprocessing/process.py", line 297, in _bootstrap
    self.run()
  File "/data1/deepdog/anaconda3/envs/mcl/lib/python3.7/multiprocessing/process.py", line 99, in run
    self._target(*self._args, **self._kwargs)
Traceback (most recent call last):
  File "/data1/deepdog/project/GFML/MCL/code/utils.py", line 113, in UniformSample_original
    while neg in allPos[user]:
  File "/data1/deepdog/anaconda3/envs/mcl/lib/python3.7/multiprocessing/process.py", line 99, in run
    self._target(*self._args, **self._kwargs)
  File "/data1/deepdog/anaconda3/envs/mcl/lib/python3.7/multiprocessing/process.py", line 99, in run
    self._target(*self._args, **self._kwargs)
  File "/data1/deepdog/project/GFML/MCL/code/utils.py", line 113, in UniformSample_original
    while neg in allPos[user]:
  File "/data1/deepdog/anaconda3/envs/mcl/lib/python3.7/multiprocessing/process.py", line 297, in _bootstrap
    self.run()
KeyboardInterrupt
  File "/data1/deepdog/project/GFML/MCL/code/utils.py", line 113, in UniformSample_original
    while neg in allPos[user]:
  File "/data1/deepdog/anaconda3/envs/mcl/lib/python3.7/multiprocessing/process.py", line 99, in run
    self._target(*self._args, **self._kwargs)
KeyboardInterrupt
  File "/data1/deepdog/project/GFML/MCL/code/utils.py", line 113, in UniformSample_original
    while neg in allPos[user]:
KeyboardInterrupt
KeyboardInterrupt
Traceback (most recent call last):
  File "main.py", line 123, in <module>
    output_information = Procedure.Metric_train_original(args, dataset, model, metric, epoch, sampler, w)
  File "/data1/deepdog/project/GFML/MCL/code/Procedure.py", line 34, in Metric_train_original
    metric_loss, reg_loss, pos_loss, neg_loss = metric.stageOne(S, num_items_per_user)
  File "/data1/deepdog/project/GFML/MCL/code/utils.py", line 39, in stageOne
    metric_loss, reg_loss, pos_loss, neg_loss = self.model.loss(S, num_items_per_user)
  File "/data1/deepdog/project/GFML/MCL/code/model.py", line 212, in loss
    pos_lengths = torch.repeat_interleave(torch.tensor(pos_lengths), num_items_per_user)
KeyboardInterrupt