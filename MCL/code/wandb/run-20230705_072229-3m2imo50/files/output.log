
Epoch 1/1000
aver metric loss3.150e+00, aver reg loss2.291e-06
Total time 16.78635573387146
Epoch 2/1000
aver metric loss2.856e+00, aver reg loss1.046e-05
Total time 14.749477624893188
Epoch 3/1000
aver metric loss2.754e+00, aver reg loss2.139e-05
Total time 16.773634672164917
Epoch 4/1000
aver metric loss2.892e+00, aver reg loss2.909e-05
Total time 16.10147714614868
Epoch 5/1000
aver metric loss2.755e+00, aver reg loss3.258e-05
Total time 16.099493503570557
Epoch 6/1000
aver metric loss2.461e+00, aver reg loss3.050e-05
Total time 15.789952754974365
Epoch 7/1000
aver metric loss2.403e+00, aver reg loss3.387e-05
Total time 15.765671968460083
Epoch 8/1000
aver metric loss2.442e+00, aver reg loss3.703e-05
Total time 16.889819383621216
Epoch 9/1000
aver metric loss2.389e+00, aver reg loss3.934e-05
Total time 15.872589588165283
Epoch 10/1000
{'precision': array([0.04221654, 0.03508759, 0.02876674]), 'recall': array([0.03431022, 0.05566715, 0.0885452 ]), 'ndcg': array([0.04844578, 0.05411519, 0.06597255])}
Best so far: [0.03431022 0.05566715 0.0885452  0.04844578 0.05411519 0.06597255]
aver metric loss2.376e+00, aver reg loss4.131e-05
Total time 30.950068712234497
Epoch 11/1000
aver metric loss2.219e+00, aver reg loss4.360e-05
Total time 16.67831325531006
Epoch 12/1000
aver metric loss2.222e+00, aver reg loss4.627e-05
Total time 15.073867082595825
Epoch 13/1000
aver metric loss2.235e+00, aver reg loss4.784e-05
Total time 14.838866233825684
Epoch 14/1000
aver metric loss2.220e+00, aver reg loss4.945e-05
Total time 17.11297369003296
Epoch 15/1000
aver metric loss2.203e+00, aver reg loss5.063e-05
Total time 16.447694301605225
Epoch 16/1000
aver metric loss2.118e+00, aver reg loss5.200e-05
Total time 16.718907117843628
Epoch 17/1000
aver metric loss2.114e+00, aver reg loss5.423e-05
Total time 16.67759370803833
Epoch 18/1000
aver metric loss2.128e+00, aver reg loss5.606e-05
Total time 15.6320960521698
Epoch 19/1000
aver metric loss2.117e+00, aver reg loss5.718e-05
Total time 16.1002197265625
Epoch 20/1000
{'precision': array([0.04864329, 0.04074152, 0.03292753]), 'recall': array([0.03950695, 0.06437817, 0.10147317]), 'ndcg': array([0.05610077, 0.0628405 , 0.07590537])}
Best so far: [0.03950695 0.06437817 0.10147317 0.05610077 0.0628405  0.07590537]
aver metric loss2.109e+00, aver reg loss5.832e-05
Total time 27.381462335586548
Epoch 21/1000
aver metric loss2.036e+00, aver reg loss5.968e-05
Total time 15.995763301849365
Epoch 22/1000
aver metric loss2.059e+00, aver reg loss6.103e-05
Total time 16.429715871810913
Epoch 23/1000
aver metric loss2.060e+00, aver reg loss6.243e-05
Total time 16.3661630153656
Epoch 24/1000
aver metric loss2.086e+00, aver reg loss6.326e-05
Total time 16.19798707962036
Epoch 25/1000
aver metric loss2.044e+00, aver reg loss6.379e-05
Total time 15.40575623512268
Epoch 26/1000
aver metric loss2.035e+00, aver reg loss6.489e-05
Total time 15.894859075546265
Epoch 27/1000
aver metric loss2.007e+00, aver reg loss6.627e-05
Total time 17.004472017288208
Epoch 28/1000
aver metric loss1.999e+00, aver reg loss6.758e-05
Total time 16.394044399261475
Epoch 29/1000
aver metric loss2.035e+00, aver reg loss6.844e-05
Total time 16.201753616333008
Epoch 30/1000
{'precision': array([0.05027287, 0.04201618, 0.03377285]), 'recall': array([0.04075805, 0.06643141, 0.10385896]), 'ndcg': array([0.05828899, 0.06514282, 0.07822468])}
Best so far: [0.04075805 0.06643141 0.10385896 0.05828899 0.06514282 0.07822468]
aver metric loss2.011e+00, aver reg loss6.917e-05
Total time 31.42736291885376
Epoch 31/1000
aver metric loss1.977e+00, aver reg loss7.026e-05
Total time 15.685924768447876
Epoch 32/1000
aver metric loss1.972e+00, aver reg loss7.147e-05
Total time 15.796634197235107
Epoch 33/1000
aver metric loss1.995e+00, aver reg loss7.255e-05
Total time 16.917798280715942
Epoch 34/1000
aver metric loss2.008e+00, aver reg loss7.304e-05
Total time 16.816761016845703
Epoch 35/1000
aver metric loss1.993e+00, aver reg loss7.350e-05
Total time 17.23514676094055
Epoch 36/1000
aver metric loss1.956e+00, aver reg loss7.435e-05
Total time 16.484411478042603
Epoch 37/1000
aver metric loss1.956e+00, aver reg loss7.542e-05
Total time 14.655698299407959
Epoch 38/1000
aver metric loss1.960e+00, aver reg loss7.646e-05
Total time 14.910282135009766
Epoch 39/1000
aver metric loss1.979e+00, aver reg loss7.739e-05
Total time 16.532992601394653
Epoch 40/1000
{'precision': array([0.05066214, 0.04223753, 0.03408675]), 'recall': array([0.0412331 , 0.06694217, 0.10453703]), 'ndcg': array([0.0585408, 0.0654376, 0.0786792])}
Best so far: [0.0412331  0.06694217 0.10453703 0.0585408  0.0654376  0.0786792 ]
aver metric loss1.936e+00, aver reg loss7.751e-05
Total time 29.305479288101196
Epoch 41/1000
aver metric loss1.922e+00, aver reg loss7.899e-05
Total time 16.439067602157593
Epoch 42/1000
aver metric loss1.925e+00, aver reg loss7.959e-05
Total time 16.094026565551758
Epoch 43/1000
aver metric loss1.941e+00, aver reg loss8.031e-05
Total time 15.795788526535034
Epoch 44/1000
aver metric loss1.958e+00, aver reg loss8.056e-05
Total time 16.458906412124634
Epoch 45/1000
aver metric loss1.944e+00, aver reg loss8.087e-05
Total time 13.443770170211792
Epoch 46/1000
aver metric loss1.939e+00, aver reg loss8.162e-05
Total time 14.6649808883667
Epoch 47/1000
aver metric loss1.939e+00, aver reg loss8.263e-05
Total time 17.232612133026123
Epoch 48/1000
aver metric loss1.934e+00, aver reg loss8.327e-05
Total time 16.124536275863647
Epoch 49/1000
aver metric loss1.929e+00, aver reg loss8.407e-05
Total time 15.154927730560303
Epoch 50/1000
{'precision': array([0.05037591, 0.04223562, 0.0341688 ]), 'recall': array([0.04071476, 0.06635247, 0.10468465]), 'ndcg': array([0.05818147, 0.06504376, 0.0784179 ])}
Best so far: [0.0412331  0.06694217 0.10453703 0.0585408  0.0654376  0.0786792 ]
aver metric loss1.890e+00, aver reg loss8.454e-05
Total time 29.810290813446045
Epoch 51/1000
aver metric loss1.882e+00, aver reg loss8.519e-05
Total time 15.287862777709961
Epoch 52/1000
aver metric loss1.915e+00, aver reg loss8.590e-05
Total time 16.389965295791626
Epoch 53/1000
aver metric loss1.923e+00, aver reg loss8.662e-05
Total time 16.260507583618164
Epoch 54/1000
aver metric loss1.946e+00, aver reg loss8.735e-05
Total time 16.04129409790039
Epoch 55/1000
aver metric loss1.896e+00, aver reg loss8.749e-05
Total time 15.364055871963501
Epoch 56/1000
aver metric loss1.908e+00, aver reg loss8.863e-05
Total time 16.067965984344482
Epoch 57/1000
aver metric loss1.893e+00, aver reg loss8.936e-05
Total time 16.242851972579956
Epoch 58/1000
aver metric loss1.922e+00, aver reg loss8.958e-05
Total time 16.5923810005188
Epoch 59/1000
aver metric loss1.948e+00, aver reg loss9.013e-05
Total time 17.023221492767334
Epoch 60/1000
{'precision': array([0.05089112, 0.04248178, 0.03423749]), 'recall': array([0.0411268 , 0.06688796, 0.10480372]), 'ndcg': array([0.05910212, 0.06583375, 0.07900558])}
Best so far: [0.0411268  0.06688796 0.10480372 0.05910212 0.06583375 0.07900558]
aver metric loss1.930e+00, aver reg loss9.022e-05
Total time 32.38718843460083
Epoch 61/1000
aver metric loss1.902e+00, aver reg loss9.086e-05
Total time 14.365026950836182
Epoch 62/1000
aver metric loss1.909e+00, aver reg loss9.157e-05
Total time 14.795451164245605
Epoch 63/1000
aver metric loss1.897e+00, aver reg loss9.180e-05
Total time 16.446088552474976
Epoch 64/1000
aver metric loss1.897e+00, aver reg loss9.222e-05
Total time 15.140713691711426
Epoch 65/1000
aver metric loss1.872e+00, aver reg loss9.260e-05
Total time 16.610759019851685
Epoch 66/1000
aver metric loss1.859e+00, aver reg loss9.348e-05
Total time 15.373627662658691
Epoch 67/1000
aver metric loss1.870e+00, aver reg loss9.383e-05
Total time 15.786629915237427
Epoch 68/1000
aver metric loss1.889e+00, aver reg loss9.429e-05
Total time 16.637157917022705
Epoch 69/1000
aver metric loss1.891e+00, aver reg loss9.473e-05
Total time 15.917681455612183
Epoch 70/1000
{'precision': array([0.05029577, 0.04218219, 0.03398466]), 'recall': array([0.04078962, 0.06645597, 0.10424295]), 'ndcg': array([0.05843759, 0.06528325, 0.0784362 ])}
Best so far: [0.0411268  0.06688796 0.10480372 0.05910212 0.06583375 0.07900558]
aver metric loss1.873e+00, aver reg loss9.464e-05
Total time 31.24121069908142
Epoch 71/1000
aver metric loss1.851e+00, aver reg loss9.573e-05
Total time 16.475208044052124
Epoch 72/1000
aver metric loss1.867e+00, aver reg loss9.652e-05
Total time 16.0685875415802
Epoch 73/1000
aver metric loss1.885e+00, aver reg loss9.648e-05
Total time 15.23557186126709
Epoch 74/1000
aver metric loss1.876e+00, aver reg loss9.720e-05
Total time 13.489606380462646
Epoch 75/1000
aver metric loss1.862e+00, aver reg loss9.721e-05
Total time 16.393091440200806
Epoch 76/1000
aver metric loss1.852e+00, aver reg loss9.803e-05
Total time 15.71243929862976
Epoch 77/1000
aver metric loss1.858e+00, aver reg loss9.817e-05
Total time 15.772742748260498
Epoch 78/1000
aver metric loss1.885e+00, aver reg loss9.871e-05
Total time 16.015396118164062
Epoch 79/1000
aver metric loss1.885e+00, aver reg loss9.923e-05
Total time 15.958019971847534
Epoch 80/1000
{'precision': array([0.04998664, 0.04206198, 0.03395413]), 'recall': array([0.04035114, 0.06605084, 0.10386136]), 'ndcg': array([0.05800169, 0.06491972, 0.0780696 ])}
Best so far: [0.0411268  0.06688796 0.10480372 0.05910212 0.06583375 0.07900558]
aver metric loss1.867e+00, aver reg loss9.905e-05
Total time 31.71132254600525
Epoch 81/1000
aver metric loss1.851e+00, aver reg loss9.963e-05
Total time 16.132067441940308
Epoch 82/1000
aver metric loss1.838e+00, aver reg loss1.006e-04
Total time 15.603866577148438
Epoch 83/1000
aver metric loss1.866e+00, aver reg loss1.006e-04
Total time 16.922893524169922
Epoch 84/1000
aver metric loss1.878e+00, aver reg loss1.013e-04
Total time 16.856223106384277
Epoch 85/1000
aver metric loss1.844e+00, aver reg loss1.011e-04
Total time 16.922876358032227
Epoch 86/1000
aver metric loss1.853e+00, aver reg loss1.019e-04
Total time 14.364203691482544
Epoch 87/1000
aver metric loss1.846e+00, aver reg loss1.024e-04
Total time 15.229525566101074
Epoch 88/1000
aver metric loss1.849e+00, aver reg loss1.022e-04
Total time 16.4378342628479
Epoch 89/1000
Traceback (most recent call last):
  File "main.py", line 123, in <module>
    output_information = Procedure.Metric_train_original(args, dataset, model, metric, epoch, sampler, w)
  File "/data1/deepdog/project/GFML/MCL/code/Procedure.py", line 34, in Metric_train_original
    metric_loss, reg_loss, pos_loss, neg_loss = metric.stageOne(S, num_items_per_user)
  File "/data1/deepdog/project/GFML/MCL/code/utils.py", line 39, in stageOne
    metric_loss, reg_loss, pos_loss, neg_loss = self.model.loss(S, num_items_per_user)
  File "/data1/deepdog/project/GFML/MCL/code/model.py", line 214, in loss
    neg_length = torch.repeat_interleave(torch.tensor(neg_length), num_items_per_user)
KeyboardInterrupt