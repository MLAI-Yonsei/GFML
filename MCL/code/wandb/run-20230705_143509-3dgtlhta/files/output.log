
Epoch 1/1000
aver metric loss7.064e+00, aver reg loss6.903e-06
Total time 18.810283660888672
Epoch 2/1000
aver metric loss6.834e+00, aver reg loss2.129e-05
Total time 17.857922554016113
Epoch 3/1000
aver metric loss7.115e+00, aver reg loss2.817e-05
Total time 18.973533630371094
Epoch 4/1000
aver metric loss6.775e+00, aver reg loss3.084e-05
Total time 17.583306074142456
Epoch 5/1000
aver metric loss6.698e+00, aver reg loss3.376e-05
Total time 18.418270111083984
Epoch 6/1000
aver metric loss6.594e+00, aver reg loss3.611e-05
Total time 18.67946743965149
Epoch 7/1000
aver metric loss6.490e+00, aver reg loss3.838e-05
Total time 18.422598838806152
Epoch 8/1000
aver metric loss6.500e+00, aver reg loss4.030e-05
Total time 18.649615049362183
Epoch 9/1000
aver metric loss6.525e+00, aver reg loss4.160e-05
Total time 18.312175035476685
Epoch 10/1000
{'precision': array([0.01909257, 0.01704972, 0.01466418]), 'recall': array([0.01968581, 0.03493405, 0.05931119]), 'ndcg': array([0.02325807, 0.02865696, 0.03724301])}
Best so far: [0.01968581 0.03493405 0.05931119 0.02325807 0.02865696 0.03724301]
aver metric loss6.557e+00, aver reg loss4.287e-05
Total time 44.02107644081116
Epoch 11/1000
aver metric loss6.363e+00, aver reg loss4.561e-05
Total time 17.96533727645874
Epoch 12/1000
aver metric loss6.376e+00, aver reg loss4.732e-05
Total time 17.503844499588013
Epoch 13/1000
aver metric loss6.397e+00, aver reg loss4.805e-05
Total time 17.080533266067505
Epoch 14/1000
aver metric loss6.385e+00, aver reg loss4.872e-05
Total time 17.94220733642578
Epoch 15/1000
aver metric loss6.377e+00, aver reg loss4.972e-05
Total time 18.222175359725952
Epoch 16/1000
aver metric loss6.297e+00, aver reg loss5.282e-05
Total time 18.949944734573364
Epoch 17/1000
aver metric loss6.320e+00, aver reg loss5.437e-05
Total time 17.8073148727417
Epoch 18/1000
aver metric loss6.316e+00, aver reg loss5.540e-05
Total time 18.606682777404785
Epoch 19/1000
aver metric loss6.361e+00, aver reg loss5.585e-05
Total time 18.45239782333374
Epoch 20/1000
{'precision': array([0.02473169, 0.02168537, 0.01844257]), 'recall': array([0.02611398, 0.04532547, 0.07634109]), 'ndcg': array([0.03053589, 0.03723581, 0.04803102])}
Best so far: [0.02611398 0.04532547 0.07634109 0.03053589 0.03723581 0.04803102]
aver metric loss6.338e+00, aver reg loss5.698e-05
Total time 42.97568202018738
Epoch 21/1000
aver metric loss6.283e+00, aver reg loss5.958e-05
Total time 17.51908302307129
Epoch 22/1000
aver metric loss6.275e+00, aver reg loss6.149e-05
Total time 18.56278967857361
Epoch 23/1000
aver metric loss6.292e+00, aver reg loss6.233e-05
Total time 19.387415885925293
Epoch 24/1000
aver metric loss6.316e+00, aver reg loss6.270e-05
Total time 18.472920417785645
Epoch 25/1000
aver metric loss6.287e+00, aver reg loss6.402e-05
Total time 18.45393180847168
Epoch 26/1000
aver metric loss6.252e+00, aver reg loss6.691e-05
Total time 18.95626735687256
Epoch 27/1000
aver metric loss6.265e+00, aver reg loss6.847e-05
Total time 18.82314705848694
Epoch 28/1000
aver metric loss6.300e+00, aver reg loss6.904e-05
Total time 18.899216413497925
Epoch 29/1000
aver metric loss6.311e+00, aver reg loss6.910e-05
Total time 18.257294178009033
Epoch 30/1000
{'precision': array([0.02640003, 0.02310439, 0.019543  ]), 'recall': array([0.02811761, 0.04882474, 0.08141206]), 'ndcg': array([0.03291283, 0.0400789 , 0.05141764])}
Best so far: [0.02811761 0.04882474 0.08141206 0.03291283 0.0400789  0.05141764]
aver metric loss6.283e+00, aver reg loss7.064e-05
Total time 43.573052644729614
Epoch 31/1000
aver metric loss6.245e+00, aver reg loss7.324e-05
Total time 18.471911430358887
Epoch 32/1000
aver metric loss6.243e+00, aver reg loss7.474e-05
Total time 17.96652102470398
Epoch 33/1000
aver metric loss6.262e+00, aver reg loss7.547e-05
Total time 18.012975692749023
Epoch 34/1000
aver metric loss6.274e+00, aver reg loss7.565e-05
Total time 18.797836303710938
Epoch 35/1000
aver metric loss6.237e+00, aver reg loss7.748e-05
Total time 18.227800130844116
Epoch 36/1000
aver metric loss6.233e+00, aver reg loss7.936e-05
Total time 18.506099700927734
Epoch 37/1000
aver metric loss6.237e+00, aver reg loss8.068e-05
Total time 17.776225805282593
Epoch 38/1000
aver metric loss6.247e+00, aver reg loss8.137e-05
Total time 17.666499614715576
Epoch 39/1000
aver metric loss6.243e+00, aver reg loss8.202e-05
Total time 18.55538296699524
Epoch 40/1000
{'precision': array([0.02726396, 0.02383493, 0.02001857]), 'recall': array([0.0288508 , 0.05016533, 0.08352416]), 'ndcg': array([0.03402156, 0.0413427 , 0.05283712])}
Best so far: [0.0288508  0.05016533 0.08352416 0.03402156 0.0413427  0.05283712]
aver metric loss6.237e+00, aver reg loss8.348e-05
Total time 41.714725494384766
Epoch 41/1000
aver metric loss6.216e+00, aver reg loss8.535e-05
Total time 19.011277437210083
Epoch 42/1000
aver metric loss6.216e+00, aver reg loss8.685e-05
Total time 19.294108867645264
Epoch 43/1000
aver metric loss6.228e+00, aver reg loss8.726e-05
Total time 19.2921142578125
Epoch 44/1000
aver metric loss6.223e+00, aver reg loss8.795e-05
Total time 17.90870451927185
Epoch 45/1000
aver metric loss6.213e+00, aver reg loss8.910e-05
Total time 13.3351411819458
Epoch 46/1000
aver metric loss6.209e+00, aver reg loss9.084e-05
Total time 15.52229905128479
Epoch 47/1000
aver metric loss6.206e+00, aver reg loss9.199e-05
Total time 18.782807111740112
Epoch 48/1000
aver metric loss6.216e+00, aver reg loss9.257e-05
Total time 19.078569412231445
Epoch 49/1000
aver metric loss6.206e+00, aver reg loss9.322e-05
Total time 18.491156339645386
Epoch 50/1000
{'precision': array([0.02754304, 0.024074  , 0.02041668]), 'recall': array([0.02928058, 0.05076557, 0.08517089]), 'ndcg': array([0.03404279, 0.04149926, 0.0534497 ])}
Best so far: [0.02928058 0.05076557 0.08517089 0.03404279 0.04149926 0.0534497 ]
aver metric loss6.206e+00, aver reg loss9.432e-05
Total time 45.366957664489746
Epoch 51/1000
aver metric loss6.190e+00, aver reg loss9.574e-05
Total time 18.723594903945923
Epoch 52/1000
aver metric loss6.195e+00, aver reg loss9.698e-05
Total time 18.790550231933594
Epoch 53/1000
aver metric loss6.203e+00, aver reg loss9.763e-05
Total time 17.462303400039673
Epoch 54/1000
aver metric loss6.203e+00, aver reg loss9.807e-05
Total time 18.32189440727234
Epoch 55/1000
aver metric loss6.203e+00, aver reg loss9.898e-05
Total time 18.027884244918823
Epoch 56/1000
aver metric loss6.196e+00, aver reg loss1.005e-04
Total time 18.572939157485962
Epoch 57/1000
aver metric loss6.200e+00, aver reg loss1.014e-04
Total time 20.083689212799072
Epoch 58/1000
aver metric loss6.185e+00, aver reg loss1.024e-04
Total time 18.150721549987793
Epoch 59/1000
aver metric loss6.204e+00, aver reg loss1.027e-04
Total time 18.196905374526978
Epoch 60/1000
{'precision': array([0.02783033, 0.02435719, 0.02055776]), 'recall': array([0.0294695 , 0.05124524, 0.08594337]), 'ndcg': array([0.03464748, 0.04220848, 0.05417929])}
Best so far: [0.0294695  0.05124524 0.08594337 0.03464748 0.04220848 0.05417929]
aver metric loss6.195e+00, aver reg loss1.034e-04
Total time 42.33922338485718
Epoch 61/1000
aver metric loss6.188e+00, aver reg loss1.044e-04
Total time 18.997448921203613
Epoch 62/1000
aver metric loss6.192e+00, aver reg loss1.055e-04
Total time 19.145617723464966
Epoch 63/1000
aver metric loss6.190e+00, aver reg loss1.064e-04
Total time 19.224091291427612
Epoch 64/1000
aver metric loss6.196e+00, aver reg loss1.067e-04
Total time 19.105972290039062
Epoch 65/1000
aver metric loss6.189e+00, aver reg loss1.077e-04
Total time 18.50674057006836
Epoch 66/1000
aver metric loss6.190e+00, aver reg loss1.085e-04
Total time 18.617971658706665
Epoch 67/1000
aver metric loss6.180e+00, aver reg loss1.094e-04
Total time 18.899038553237915
Epoch 68/1000
aver metric loss6.185e+00, aver reg loss1.105e-04
Total time 18.843947887420654
Epoch 69/1000
aver metric loss6.187e+00, aver reg loss1.104e-04
Total time 18.83070969581604
Epoch 70/1000
{'precision': array([0.02796167, 0.02444029, 0.02061368]), 'recall': array([0.02947417, 0.05135887, 0.08569662]), 'ndcg': array([0.03467236, 0.04225784, 0.05413549])}
Best so far: [0.0294695  0.05124524 0.08594337 0.03464748 0.04220848 0.05417929]
aver metric loss6.187e+00, aver reg loss1.114e-04
Total time 44.013014793395996
Epoch 71/1000
aver metric loss6.171e+00, aver reg loss1.125e-04
Total time 18.941548109054565
Epoch 72/1000
aver metric loss6.182e+00, aver reg loss1.131e-04
Total time 19.47743582725525
Epoch 73/1000
aver metric loss6.175e+00, aver reg loss1.138e-04
Total time 18.49392342567444
Epoch 74/1000
aver metric loss6.180e+00, aver reg loss1.143e-04
Total time 18.358344793319702
Epoch 75/1000
aver metric loss6.183e+00, aver reg loss1.142e-04
Total time 18.82449698448181
Epoch 76/1000
aver metric loss6.167e+00, aver reg loss1.160e-04
Total time 19.243410348892212
Epoch 77/1000
aver metric loss6.186e+00, aver reg loss1.162e-04
Total time 18.59422731399536
Epoch 78/1000
aver metric loss6.175e+00, aver reg loss1.169e-04
Total time 18.961625814437866
Epoch 79/1000
aver metric loss6.178e+00, aver reg loss1.170e-04
Total time 19.30779457092285
Epoch 80/1000
{'precision': array([0.0279432 , 0.02445671, 0.02065266]), 'recall': array([0.02929202, 0.05115565, 0.08600458]), 'ndcg': array([0.0348274 , 0.04231943, 0.05430229])}
Best so far: [0.02929202 0.05115565 0.08600458 0.0348274  0.04231943 0.05430229]
aver metric loss6.183e+00, aver reg loss1.180e-04
Total time 45.262582302093506
Epoch 81/1000
aver metric loss6.172e+00, aver reg loss1.187e-04
Total time 19.242143869400024
Epoch 82/1000
aver metric loss6.171e+00, aver reg loss1.194e-04
Total time 18.730347871780396
Epoch 83/1000
aver metric loss6.171e+00, aver reg loss1.197e-04
Total time 19.064420461654663
Epoch 84/1000
aver metric loss6.182e+00, aver reg loss1.203e-04
Total time 18.839197635650635
Epoch 85/1000
aver metric loss6.169e+00, aver reg loss1.205e-04
Total time 18.446365118026733
Epoch 86/1000
aver metric loss6.167e+00, aver reg loss1.217e-04
Total time 18.747697353363037
Epoch 87/1000
aver metric loss6.173e+00, aver reg loss1.221e-04
Total time 19.262258529663086
Epoch 88/1000
aver metric loss6.170e+00, aver reg loss1.224e-04
Total time 18.9962215423584
Epoch 89/1000
aver metric loss6.176e+00, aver reg loss1.228e-04
Total time 18.785462379455566
Epoch 90/1000
{'precision': array([0.0277031 , 0.02440131, 0.020646  ]), 'recall': array([0.02902055, 0.0510226 , 0.08576416]), 'ndcg': array([0.03450322, 0.04211013, 0.05409952])}
Best so far: [0.02929202 0.05115565 0.08600458 0.0348274  0.04231943 0.05430229]
aver metric loss6.172e+00, aver reg loss1.234e-04
Total time 42.81781888008118
Epoch 91/1000
aver metric loss6.170e+00, aver reg loss1.240e-04
Total time 18.79642963409424
Epoch 92/1000
aver metric loss6.169e+00, aver reg loss1.245e-04
Total time 18.481577396392822
Epoch 93/1000
aver metric loss6.170e+00, aver reg loss1.256e-04
Total time 19.219287872314453
Epoch 94/1000
aver metric loss6.180e+00, aver reg loss1.254e-04
Total time 18.289668798446655
Epoch 95/1000
aver metric loss6.163e+00, aver reg loss1.258e-04
Total time 18.02077341079712
Epoch 96/1000
aver metric loss6.169e+00, aver reg loss1.263e-04
Total time 18.685538291931152
Epoch 97/1000
aver metric loss6.164e+00, aver reg loss1.270e-04
Total time 19.275917768478394
Epoch 98/1000
aver metric loss6.161e+00, aver reg loss1.276e-04
Total time 19.270797729492188
Epoch 99/1000
Traceback (most recent call last):
  File "main.py", line 123, in <module>
    output_information = Procedure.Metric_train_original(args, dataset, model, metric, epoch, sampler, w)
  File "/data1/deepdog/project/GFML/MCL/code/Procedure.py", line 34, in Metric_train_original
    metric_loss, reg_loss, pos_loss, neg_loss = metric.stageOne(S, num_items_per_user)
  File "/data1/deepdog/project/GFML/MCL/code/utils.py", line 39, in stageOne
    metric_loss, reg_loss, pos_loss, neg_loss = self.model.loss(S, num_items_per_user)
  File "/data1/deepdog/project/GFML/MCL/code/model.py", line 205, in loss
    max_pos_length = pos_distances[start_idx: start_idx + i].max()
KeyboardInterrupt