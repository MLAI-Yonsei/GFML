Epoch 1/1000
aver metric loss4.742e+00, aver reg loss4.653e-06
Total time 1.3527531623840332
Epoch 2/1000
aver metric loss4.727e+00, aver reg loss4.657e-06
Total time 0.919625997543335
Epoch 3/1000
aver metric loss4.750e+00, aver reg loss4.641e-06
Total time 1.0101826190948486
Epoch 4/1000
aver metric loss4.753e+00, aver reg loss4.629e-06
Total time 0.9955477714538574
Epoch 5/1000
aver metric loss4.735e+00, aver reg loss4.608e-06
Total time 0.9916317462921143
Epoch 6/1000
aver metric loss4.708e+00, aver reg loss4.597e-06
Total time 0.9021999835968018
Epoch 7/1000
aver metric loss4.741e+00, aver reg loss4.588e-06
Total time 0.9763610363006592
Epoch 8/1000
aver metric loss4.740e+00, aver reg loss4.591e-06
Total time 0.9709746837615967
Epoch 9/1000
aver metric loss4.748e+00, aver reg loss4.582e-06
Total time 1.010490894317627
Epoch 10/1000
{'precision': array([0.0053135 , 0.00492384, 0.00396741]), 'recall': array([0.01451366, 0.02814159, 0.04492218]), 'ndcg': array([0.01074138, 0.01549689, 0.02021064])}
Best so far: [0.01451366 0.02814159 0.04492218 0.01074138 0.01549689 0.02021064]
aver metric loss4.742e+00, aver reg loss4.577e-06
Total time 1.814246654510498
Epoch 11/1000
aver metric loss4.749e+00, aver reg loss4.568e-06
Total time 1.0528640747070312
Epoch 12/1000
aver metric loss4.735e+00, aver reg loss4.573e-06
Total time 0.9629852771759033
Epoch 13/1000
aver metric loss4.732e+00, aver reg loss4.591e-06
Total time 0.7671802043914795
Epoch 14/1000
aver metric loss4.725e+00, aver reg loss4.603e-06
Total time 0.6337227821350098
Epoch 15/1000
aver metric loss4.726e+00, aver reg loss4.612e-06
Total time 0.5979502201080322
Epoch 16/1000
aver metric loss4.729e+00, aver reg loss4.621e-06
Total time 0.7111055850982666
Epoch 17/1000
aver metric loss4.722e+00, aver reg loss4.627e-06
Total time 0.856097936630249
Epoch 18/1000
aver metric loss4.734e+00, aver reg loss4.647e-06
Total time 0.8895339965820312
Epoch 19/1000
aver metric loss4.718e+00, aver reg loss4.661e-06
Total time 1.1061656475067139
Epoch 20/1000
{'precision': array([0.01119377, 0.00931633, 0.00779313]), 'recall': array([0.0287118 , 0.04920768, 0.08544539]), 'ndcg': array([0.02152151, 0.02865026, 0.03881011])}
Best so far: [0.0287118  0.04920768 0.08544539 0.02152151 0.02865026 0.03881011]
aver metric loss4.728e+00, aver reg loss4.681e-06
Total time 1.9090356826782227
Epoch 21/1000
aver metric loss4.717e+00, aver reg loss4.707e-06
Total time 0.8492403030395508
Epoch 22/1000
aver metric loss4.726e+00, aver reg loss4.731e-06
Total time 0.721580982208252
Epoch 23/1000
aver metric loss4.702e+00, aver reg loss4.774e-06
Total time 0.8610324859619141
Epoch 24/1000
aver metric loss4.719e+00, aver reg loss4.806e-06
Total time 0.7876527309417725
Epoch 25/1000
aver metric loss4.704e+00, aver reg loss4.842e-06
Total time 1.0738489627838135
Epoch 26/1000
aver metric loss4.721e+00, aver reg loss4.883e-06
Total time 1.11458158493042
Epoch 27/1000
aver metric loss4.716e+00, aver reg loss4.910e-06
Total time 0.9190027713775635
Epoch 28/1000
aver metric loss4.698e+00, aver reg loss4.959e-06
Total time 0.8943636417388916
Epoch 29/1000
aver metric loss4.698e+00, aver reg loss4.997e-06
Total time 0.901038646697998
Epoch 30/1000
{'precision': array([0.01629472, 0.01441729, 0.01142402]), 'recall': array([0.04310979, 0.07859954, 0.12523279]), 'ndcg': array([0.03272737, 0.04505284, 0.05827764])}
Best so far: [0.04310979 0.07859954 0.12523279 0.03272737 0.04505284 0.05827764]
aver metric loss4.693e+00, aver reg loss5.043e-06
Total time 1.5325629711151123
Epoch 31/1000
aver metric loss4.691e+00, aver reg loss5.099e-06
Total time 0.8616926670074463
Epoch 32/1000
aver metric loss4.700e+00, aver reg loss5.159e-06
Total time 0.7816729545593262
Epoch 33/1000
aver metric loss4.703e+00, aver reg loss5.202e-06
Total time 0.8689846992492676
Epoch 34/1000
aver metric loss4.694e+00, aver reg loss5.267e-06
Total time 0.8557546138763428
Epoch 35/1000
aver metric loss4.685e+00, aver reg loss5.329e-06
Total time 1.0655789375305176
Epoch 36/1000
aver metric loss4.686e+00, aver reg loss5.400e-06
Total time 0.9697644710540771
Epoch 37/1000
aver metric loss4.691e+00, aver reg loss5.455e-06
Total time 1.0474541187286377
Epoch 38/1000
aver metric loss4.664e+00, aver reg loss5.546e-06
Total time 1.0839653015136719
Epoch 39/1000
aver metric loss4.680e+00, aver reg loss5.599e-06
Total time 1.0585808753967285
Epoch 40/1000
{'precision': array([0.02139568, 0.01742827, 0.01372653]), 'recall': array([0.06052126, 0.09927101, 0.15578938]), 'ndcg': array([0.04314078, 0.05666323, 0.07270637])}
Best so far: [0.06052126 0.09927101 0.15578938 0.04314078 0.05666323 0.07270637]
aver metric loss4.672e+00, aver reg loss5.683e-06
Total time 1.7329459190368652
Epoch 41/1000
aver metric loss4.659e+00, aver reg loss5.740e-06
Total time 0.8768513202667236
Epoch 42/1000
aver metric loss4.667e+00, aver reg loss5.839e-06
Total time 0.7704739570617676
Epoch 43/1000
aver metric loss4.678e+00, aver reg loss5.921e-06
Total time 0.7262258529663086
Epoch 44/1000
aver metric loss4.670e+00, aver reg loss5.960e-06
Total time 0.724083662033081
Epoch 45/1000
aver metric loss4.662e+00, aver reg loss6.062e-06
Total time 0.9436275959014893
Epoch 46/1000
aver metric loss4.687e+00, aver reg loss6.151e-06
Total time 0.9634060859680176
Epoch 47/1000
aver metric loss4.687e+00, aver reg loss6.221e-06
Total time 0.9364728927612305
Epoch 48/1000
aver metric loss4.633e+00, aver reg loss6.314e-06
Total time 0.9333407878875732
Epoch 49/1000
aver metric loss4.647e+00, aver reg loss6.441e-06
Total time 0.8452880382537842
Epoch 50/1000
{'precision': array([0.02515055, 0.01955367, 0.01526745]), 'recall': array([0.07351642, 0.11465232, 0.17585916]), 'ndcg': array([0.05325127, 0.06729114, 0.08467897])}
Best so far: [0.07351642 0.11465232 0.17585916 0.05325127 0.06729114 0.08467897]
aver metric loss4.661e+00, aver reg loss6.470e-06
Total time 1.8470127582550049
Epoch 51/1000
aver metric loss4.649e+00, aver reg loss6.629e-06
Total time 0.9319441318511963
Epoch 52/1000
aver metric loss4.645e+00, aver reg loss6.704e-06
Total time 1.1228744983673096
Epoch 53/1000
aver metric loss4.647e+00, aver reg loss6.822e-06
Total time 1.0231339931488037
Epoch 54/1000
aver metric loss4.612e+00, aver reg loss6.913e-06
Total time 1.0562777519226074
Epoch 55/1000
aver metric loss4.660e+00, aver reg loss6.965e-06
Total time 1.2248952388763428
Epoch 56/1000
aver metric loss4.624e+00, aver reg loss7.113e-06
Total time 0.985508918762207
Epoch 57/1000
aver metric loss4.635e+00, aver reg loss7.185e-06
Total time 0.8997547626495361
Epoch 58/1000
aver metric loss4.626e+00, aver reg loss7.339e-06
Total time 0.949364185333252
Epoch 59/1000
aver metric loss4.610e+00, aver reg loss7.479e-06
Total time 0.973111629486084
Epoch 60/1000
{'precision': array([0.02592986, 0.02107687, 0.01664896]), 'recall': array([0.07534662, 0.12548744, 0.19347735]), 'ndcg': array([0.05635849, 0.07369819, 0.09310626])}
Best so far: [0.07534662 0.12548744 0.19347735 0.05635849 0.07369819 0.09310626]
aver metric loss4.627e+00, aver reg loss7.518e-06
Total time 1.6418521404266357
Epoch 61/1000
aver metric loss4.625e+00, aver reg loss7.679e-06
Total time 1.2177164554595947
Epoch 62/1000
aver metric loss4.644e+00, aver reg loss7.706e-06
Total time 1.0244641304016113
Epoch 63/1000
aver metric loss4.612e+00, aver reg loss7.868e-06
Total time 0.8891546726226807
Epoch 64/1000
aver metric loss4.623e+00, aver reg loss7.909e-06
Total time 1.0538570880889893
Epoch 65/1000
aver metric loss4.603e+00, aver reg loss8.041e-06
Total time 1.043200969696045
Epoch 66/1000
aver metric loss4.606e+00, aver reg loss8.140e-06
Total time 0.9693694114685059
Epoch 67/1000
aver metric loss4.604e+00, aver reg loss8.296e-06
Total time 0.9481699466705322
Epoch 68/1000
aver metric loss4.604e+00, aver reg loss8.426e-06
Total time 0.9419941902160645
Epoch 69/1000
aver metric loss4.599e+00, aver reg loss8.576e-06
Total time 0.8411273956298828
Epoch 70/1000
{'precision': array([0.02763018, 0.0224938 , 0.01746369]), 'recall': array([0.08224507, 0.13333892, 0.2041297 ]), 'ndcg': array([0.06072687, 0.07866054, 0.09877696])}
Best so far: [0.08224507 0.13333892 0.2041297  0.06072687 0.07866054 0.09877696]
aver metric loss4.606e+00, aver reg loss8.698e-06
Total time 1.2868139743804932
Epoch 71/1000
aver metric loss4.593e+00, aver reg loss8.788e-06
Total time 0.3645896911621094
Epoch 72/1000
Traceback (most recent call last):
  File "main.py", line 123, in <module>
    output_information = Procedure.Metric_train_original(args, dataset, model, metric, epoch, sampler, w)
  File "/data1/deepdog/project/GFML/MCL/code/Procedure.py", line 34, in Metric_train_original
    metric_loss, reg_loss, pos_loss, neg_loss = metric.stageOne(S, num_items_per_user)
  File "/data1/deepdog/project/GFML/MCL/code/utils.py", line 39, in stageOne
    metric_loss, reg_loss, pos_loss, neg_loss = self.model.loss(S, num_items_per_user)
  File "/data1/deepdog/project/GFML/MCL/code/model.py", line 205, in loss
    min_neg_length = min_neg_per_item[start_idx: start_idx + i].min()
KeyboardInterrupt