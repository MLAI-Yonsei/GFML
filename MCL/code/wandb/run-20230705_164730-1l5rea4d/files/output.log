
Epoch 1/1000
aver metric loss5.324e+00, aver reg loss2.620e-06
Total time 15.432495594024658
Epoch 2/1000
aver metric loss5.130e+00, aver reg loss1.001e-05
Total time 14.402257919311523
Epoch 3/1000
aver metric loss5.083e+00, aver reg loss1.761e-05
Total time 13.697810173034668
Epoch 4/1000
aver metric loss5.137e+00, aver reg loss2.312e-05
Total time 15.195411205291748
Epoch 5/1000
aver metric loss5.023e+00, aver reg loss2.581e-05
Total time 15.274544954299927
Epoch 6/1000
aver metric loss4.774e+00, aver reg loss2.548e-05
Total time 15.718268394470215
Epoch 7/1000
aver metric loss4.727e+00, aver reg loss2.827e-05
Total time 15.693383693695068
Epoch 8/1000
aver metric loss4.751e+00, aver reg loss3.085e-05
Total time 16.393754243850708
Epoch 9/1000
aver metric loss4.714e+00, aver reg loss3.273e-05
Total time 15.403962850570679
Epoch 10/1000
{'precision': array([0.0419036 , 0.03561043, 0.02917319]), 'recall': array([0.03392327, 0.05628771, 0.08956524]), 'ndcg': array([0.04850526, 0.05478697, 0.06672231])}
Best so far: [0.03392327 0.05628771 0.08956524 0.04850526 0.05478697 0.06672231]
aver metric loss4.691e+00, aver reg loss3.456e-05
Total time 29.461893558502197
Epoch 11/1000
aver metric loss4.564e+00, aver reg loss3.658e-05
Total time 15.370028495788574
Epoch 12/1000
aver metric loss4.585e+00, aver reg loss3.853e-05
Total time 16.378819704055786
Epoch 13/1000
aver metric loss4.586e+00, aver reg loss3.975e-05
Total time 16.206082344055176
Epoch 14/1000
aver metric loss4.602e+00, aver reg loss4.097e-05
Total time 14.271541357040405
Epoch 15/1000
aver metric loss4.583e+00, aver reg loss4.175e-05
Total time 14.448606252670288
Epoch 16/1000
aver metric loss4.510e+00, aver reg loss4.285e-05
Total time 15.3527512550354
Epoch 17/1000
aver metric loss4.512e+00, aver reg loss4.444e-05
Total time 15.996071577072144
Epoch 18/1000
aver metric loss4.508e+00, aver reg loss4.574e-05
Total time 15.804900169372559
Epoch 19/1000
aver metric loss4.527e+00, aver reg loss4.642e-05
Total time 15.81065583229065
Epoch 20/1000
{'precision': array([0.05020799, 0.04202954, 0.03396844]), 'recall': array([0.04060235, 0.06601464, 0.10414075]), 'ndcg': array([0.05794995, 0.06478498, 0.07814398])}
Best so far: [0.04060235 0.06601464 0.10414075 0.05794995 0.06478498 0.07814398]
aver metric loss4.510e+00, aver reg loss4.716e-05
Total time 30.64752435684204
Epoch 21/1000
aver metric loss4.445e+00, aver reg loss4.805e-05
Total time 16.127119541168213
Epoch 22/1000
aver metric loss4.473e+00, aver reg loss4.917e-05
Total time 15.325758457183838
Epoch 23/1000
aver metric loss4.485e+00, aver reg loss4.990e-05
Total time 15.307643175125122
Epoch 24/1000
aver metric loss4.479e+00, aver reg loss5.053e-05
Total time 16.02605152130127
Epoch 25/1000
aver metric loss4.515e+00, aver reg loss5.082e-05
Total time 15.890190601348877
Epoch 26/1000
aver metric loss4.473e+00, aver reg loss5.124e-05
Total time 15.950363636016846
Epoch 27/1000
aver metric loss4.440e+00, aver reg loss5.255e-05
Total time 13.878287076950073
Epoch 28/1000
aver metric loss4.428e+00, aver reg loss5.328e-05
Total time 13.856650829315186
Epoch 29/1000
aver metric loss4.463e+00, aver reg loss5.381e-05
Total time 16.305596590042114
Epoch 30/1000
{'precision': array([0.05185284, 0.04339579, 0.03484906]), 'recall': array([0.0418153 , 0.06814033, 0.10654341]), 'ndcg': array([0.05974577, 0.06683356, 0.08016478])}
Best so far: [0.0418153  0.06814033 0.10654341 0.05974577 0.06683356 0.08016478]
aver metric loss4.453e+00, aver reg loss5.420e-05
Total time 29.906455516815186
Epoch 31/1000
aver metric loss4.380e+00, aver reg loss5.488e-05
Total time 15.592618465423584
Epoch 32/1000
aver metric loss4.429e+00, aver reg loss5.571e-05
Total time 15.671816349029541
Epoch 33/1000
aver metric loss4.436e+00, aver reg loss5.628e-05
Total time 16.43758487701416
Epoch 34/1000
aver metric loss4.448e+00, aver reg loss5.676e-05
Total time 16.218114137649536
Epoch 35/1000
aver metric loss4.434e+00, aver reg loss5.667e-05
Total time 15.266618728637695
Epoch 36/1000
aver metric loss4.406e+00, aver reg loss5.705e-05
Total time 16.120240211486816
Epoch 37/1000
aver metric loss4.390e+00, aver reg loss5.806e-05
Total time 15.513756513595581
Epoch 38/1000
aver metric loss4.388e+00, aver reg loss5.871e-05
Total time 14.47723913192749
Epoch 39/1000
aver metric loss4.398e+00, aver reg loss5.916e-05
Total time 14.634974241256714
Epoch 40/1000
{'precision': array([0.05284509, 0.0441915 , 0.0356276 ]), 'recall': array([0.04259404, 0.0696139 , 0.10852281]), 'ndcg': array([0.06078456, 0.06797435, 0.08159418])}
Best so far: [0.04259404 0.0696139  0.10852281 0.06078456 0.06797435 0.08159418]
aver metric loss4.411e+00, aver reg loss5.908e-05
Total time 27.439071655273438
Epoch 41/1000
aver metric loss4.380e+00, aver reg loss6.004e-05
Total time 15.675535917282104
Epoch 42/1000
aver metric loss4.364e+00, aver reg loss6.062e-05
Total time 16.29469394683838
Epoch 43/1000
aver metric loss4.399e+00, aver reg loss6.106e-05
Total time 16.023810148239136
Epoch 44/1000
aver metric loss4.406e+00, aver reg loss6.095e-05
Total time 15.782032251358032
Epoch 45/1000
aver metric loss4.417e+00, aver reg loss6.091e-05
Total time 16.307774543762207
Epoch 46/1000
aver metric loss4.387e+00, aver reg loss6.141e-05
Total time 16.484893083572388
Epoch 47/1000
aver metric loss4.386e+00, aver reg loss6.211e-05
Total time 15.893778085708618
Epoch 48/1000
aver metric loss4.370e+00, aver reg loss6.246e-05
Total time 15.87296438217163
Epoch 49/1000
aver metric loss4.367e+00, aver reg loss6.304e-05
Total time 16.094547271728516
Epoch 50/1000
{'precision': array([0.05329542, 0.04449491, 0.03597393]), 'recall': array([0.0425817 , 0.06937284, 0.10936287]), 'ndcg': array([0.06159696, 0.06852327, 0.08239727])}
Best so far: [0.0425817  0.06937284 0.10936287 0.06159696 0.06852327 0.08239727]
aver metric loss4.340e+00, aver reg loss6.310e-05
Total time 30.392180919647217
Epoch 51/1000
aver metric loss4.337e+00, aver reg loss6.368e-05
Total time 14.569465398788452
Epoch 52/1000
aver metric loss4.370e+00, aver reg loss6.409e-05
Total time 13.002393245697021
Epoch 53/1000
aver metric loss4.371e+00, aver reg loss6.452e-05
Total time 16.089293718338013
Epoch 54/1000
aver metric loss4.373e+00, aver reg loss6.473e-05
Total time 15.83972978591919
Epoch 55/1000
aver metric loss4.338e+00, aver reg loss6.483e-05
Total time 15.799261093139648
Epoch 56/1000
aver metric loss4.342e+00, aver reg loss6.551e-05
Total time 15.675090789794922
Epoch 57/1000
aver metric loss4.324e+00, aver reg loss6.594e-05
Total time 16.406771659851074
Epoch 58/1000
aver metric loss4.370e+00, aver reg loss6.617e-05
Total time 17.088948249816895
Epoch 59/1000
aver metric loss4.378e+00, aver reg loss6.657e-05
Total time 17.010853052139282
Epoch 60/1000
{'precision': array([0.05395565, 0.04520093, 0.03631931]), 'recall': array([0.04337603, 0.07054834, 0.11055844]), 'ndcg': array([0.06264232, 0.06973193, 0.08352713])}
Best so far: [0.04337603 0.07054834 0.11055844 0.06264232 0.06973193 0.08352713]
aver metric loss4.373e+00, aver reg loss6.629e-05
Total time 29.228368043899536
Epoch 61/1000
aver metric loss4.348e+00, aver reg loss6.689e-05
Total time 16.205360651016235
Epoch 62/1000
aver metric loss4.360e+00, aver reg loss6.720e-05
Total time 15.879132986068726
Epoch 63/1000
aver metric loss4.339e+00, aver reg loss6.749e-05
Total time 15.261205434799194
Epoch 64/1000
aver metric loss4.358e+00, aver reg loss6.775e-05
Total time 13.42479944229126
Epoch 65/1000
aver metric loss4.330e+00, aver reg loss6.792e-05
Total time 15.304527759552002
Epoch 66/1000
aver metric loss4.310e+00, aver reg loss6.839e-05
Total time 15.498615026473999
Epoch 67/1000
aver metric loss4.335e+00, aver reg loss6.882e-05
Total time 15.22662878036499
Epoch 68/1000
aver metric loss4.332e+00, aver reg loss6.907e-05
Total time 15.295500040054321
Epoch 69/1000
Traceback (most recent call last):
  File "main.py", line 123, in <module>
    output_information = Procedure.Metric_train_original(args, dataset, model, metric, epoch, sampler, w)
  File "/data1/deepdog/project/GFML/MCL/code/Procedure.py", line 34, in Metric_train_original
    metric_loss, reg_loss, pos_loss, neg_loss = metric.stageOne(S, num_items_per_user)
  File "/data1/deepdog/project/GFML/MCL/code/utils.py", line 39, in stageOne
    metric_loss, reg_loss, pos_loss, neg_loss = self.model.loss(S, num_items_per_user)
  File "/data1/deepdog/project/GFML/MCL/code/model.py", line 152, in loss
    neg_items = torch.Tensor(S[:, 2:]).long()
KeyboardInterrupt